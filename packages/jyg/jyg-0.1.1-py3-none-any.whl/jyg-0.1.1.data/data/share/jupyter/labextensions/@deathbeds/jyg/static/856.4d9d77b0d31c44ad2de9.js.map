{"version":3,"file":"856.4d9d77b0d31c44ad2de9.js?v=4d9d77b0d31c44ad2de9","mappings":"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","sources":["webpack://@deathbeds/jyg/./style/img/logo.svg","webpack://@deathbeds/jyg/./js/icons.ts","webpack://@deathbeds/jyg/./js/manager.ts","webpack://@deathbeds/jyg/./js/sources/_base.ts","webpack://@deathbeds/jyg/./js/sources/websocket.ts","webpack://@deathbeds/jyg/./js/sources/window-proxy.ts","webpack://@deathbeds/jyg/./js/tokens.ts"],"sourcesContent":["export default \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg width=\\\"24\\\" height=\\\"24\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 6.35 6.35\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n <g class=\\\"jp-icon3 jp-icon-selectable\\\" transform=\\\"matrix(.92922 0 0 .92922 .22474 .22474)\\\" fill=\\\"#f57c00\\\">\\n  <path transform=\\\"scale(.26458)\\\" d=\\\"m12-0.03125a12.032 12.032 0 0 0-12.031 12.031 12.032 12.032 0 0 0 12.031 12.031 12.032 12.032 0 0 0 12.031-12.031 12.032 12.032 0 0 0-12.031-12.031zm0 0.91602a11.116 11.116 0 0 1 11.115 11.115 11.116 11.116 0 0 1-11.115 11.115 11.116 11.116 0 0 1-11.115-11.115 11.116 11.116 0 0 1 11.115-11.115zm0 0.71484a10.401 10.401 0 0 0-10.4 10.4 10.401 10.401 0 0 0 10.4 10.4 10.401 10.401 0 0 0 10.4-10.4 10.401 10.401 0 0 0-10.4-10.4zm-1.3672 3.7871c0.26068-7.824e-4 0.45697-7.106e-4 0.60156 0 0.28918 0.00113 0.37693 0.00573 0.38672 0.013672 0.06982 0.057938 0.1076 0.24281 0.07813 0.38477-0.01342 0.064547-0.03092 0.093419-0.07813 0.14062-0.06013 0.06017-0.094 0.073824-0.29492 0.11914-0.19108 0.04309-0.37373 0.17724-0.45117 0.33008-0.11641 0.22974-0.10759 0.36919 0.05273 0.98828 0.11894 0.45929 0.43333 1.5431 0.74219 2.5508 0.67068 2.1882 0.74551 2.4178 0.78516 2.4473 0.02653 0.01999 0.10163 0.02482 0.12695 0.0078 0.03772-0.02482 0.09743-0.18285 0.27734-0.7207 0.52807-1.6142 1.0158-3.1455 1.5176-4.7539 0.07018-0.26237 0.02869-0.50274-0.10938-0.63672-0.07453-0.07234-0.20986-0.15128-0.30469-0.17773-0.23953-0.066939-0.39308-0.16247-0.43945-0.27344-0.04532-0.10851 4.56e-4 -0.31255 0.08398-0.38281l0.04102-0.037109 1.3008 0.00977 1.2988 0.00781 0.08008 0.056641c0.14754 0.10269 0.17598 0.20816 0.0957 0.35938-0.07083 0.13341-0.14138 0.19942-0.26758 0.24609-0.19246 0.071199-0.38694 0.18051-0.47266 0.26562-0.11911 0.11826-0.26091 0.39812-0.43359 0.85938-0.98009 2.8113-1.617 4.8332-2.5449 7.5957 7.94e-4 0.87099 4e-3 2.2963 0.0098 2.4629 0.01777 0.52257 0.01604 0.50823 0.14844 0.64062 0.09405 0.09404 0.18756 0.13649 0.41992 0.19141 0.37201 0.08787 0.46115 0.15293 0.46094 0.32617-7.2e-5 0.06853-0.01091 0.106-0.04492 0.14844l-0.04492 0.05664h-1.4121c-0.77606 0-1.4433-0.0073-1.4824-0.01563-0.0511-0.01096-0.0792-0.0307-0.09961-0.07031-0.03247-0.0632-0.03654-0.23089-0.0078-0.28516 0.02536-0.04702 0.12112-0.09566 0.37109-0.1875 0.11037-0.04055 0.22197-0.09495 0.24805-0.11914 0.09548-0.0892 0.10107-1.5209 0.11328-3.0078-0.90713-2.6362-1.6524-5.3279-2.6954-8.209-0.077779-0.15408-0.31265-0.41201-0.48242-0.53125-0.037908-0.026528-0.18222-0.10679-0.32422-0.17773-0.22133-0.11055-0.26601-0.13772-0.30078-0.1875-0.08417-0.12015-0.06153-0.2986 0.048828-0.38281l0.048828-0.037109 1.959-0.00977c0.40761-0.00224 0.73343-0.00312 0.99414-0.00391zm6.9434 6.2871c0.0853-0.0029 0.17262 2e-3 0.25781 0.01172 0.23176 0.02684 0.49636 0.09132 0.70703 0.17383 0.26309 0.10307 0.34415 0.09664 0.55078-0.04883 0.06618-0.0466 0.14762-0.08932 0.18164-0.0957 0.13535-0.02532 0.26899 0.07085 0.35547 0.25586 0.03892 0.0833 0.04102 0.11325 0.04102 0.65625 0 0.60568-0.0082 0.68311-0.08984 0.74024-0.06002 0.04204-0.16694 0.03426-0.23438-0.01563-0.08496-0.06271-0.14315-0.1359-0.24414-0.31641-0.1068-0.19087-0.26947-0.4124-0.3457-0.46875-0.16875-0.12468-0.42058-0.19516-0.68945-0.19531-0.25138-1.48e-4 -0.43216 0.06053-0.65039 0.2207-0.16358 0.12008-0.32441 0.36353-0.44727 0.67383-0.21789 0.55019-0.28223 1.2576-0.16602 1.8281 0.09581 0.47039 0.21946 0.7718 0.42969 1.0508 0.23592 0.31306 0.46426 0.46274 0.72461 0.47461 0.18334 0.0083 0.38258-0.03418 0.55859-0.11914 0.28411-0.13681 0.62487-0.44755 0.82812-0.75195h-0.0078c0.05124-0.11714 0.14401-0.72585 0.0098-0.95508-0.0015-0.01595-0.012-0.0823-0.09375-0.08789l-0.35938 0.01367a0.66963 0.66963 0 0 1 0.02344 0.17188 0.66963 0.66963 0 0 1-0.66992 0.66992 0.66963 0.66963 0 0 1-0.66992-0.66992 0.66963 0.66963 0 0 1 0.46875-0.63672c9.93e-4 -8e-4 0.0028-0.0012 0.0039-2e-3 0.01028-0.0067 0.02275-0.01197 0.04297-0.01367 0.0012-9.5e-5 0.0027 7.6e-5 0.0039 0a0.66963 0.66963 0 0 1 0.15039-0.01758 0.66963 0.66963 0 0 1 0.13672 0.01563h2e-3l1.2637-0.0078c0.0898-0.01259 0.15953 0.03542 0.17578 0.16211 0.0091 0.2462-0.0049 1.1493-0.04297 1.3652h-0.0039c-0.01392 0.08842-0.04832 0.19151-0.10547 0.30664-0.243 0.48974-0.7617 0.90754-1.2988 1.0469-0.14838 0.03852-0.23883 0.04744-0.47656 0.05273-0.1618 0.0036-0.31572 0.0025-0.3418-2e-3 -0.02607-0.0045-0.11115-0.01638-0.18945-0.02734-0.44571-0.0632-0.7918-0.23409-1.0625-0.52344-0.36484-0.39-0.69952-1.1406-0.78125-1.752-0.02722-0.20383-0.01039-0.74842 0.0293-0.96484 0.10168-0.5533 0.26771-1.0099 0.49024-1.3418 0.3547-0.52896 0.93805-0.85654 1.5352-0.87695zm-12.154 0.26953h1.4121c0.77606 0 1.4433 0.0073 1.4824 0.01563 0.051062 0.01096 0.079124 0.0307 0.099609 0.07031 0.032504 0.0632 0.03665 0.23089 0.00781 0.28516-0.025319 0.04702-0.12112 0.09566-0.37109 0.1875-0.11037 0.04055-0.22201 0.09484-0.24805 0.11914-0.10742 0.1003-0.10225 0.02613-0.11914 1.6914-0.01474 1.4561-0.018593 1.549-0.054687 1.6836-0.10431 0.38846-0.29646 0.72462-0.57617 1.0078-0.26185 0.26513-0.52193 0.39401-0.89844 0.44336-0.49983 0.06554-1.0302-0.0097-1.3281-0.18945-0.15572-0.09392-0.44576-0.33317-0.53125-0.4375-0.1079-0.13168-0.19432-0.28666-0.22656-0.4043-0.015874-0.05855-0.056319-0.16263-0.089844-0.23047-0.044924-0.09098-0.062955-0.15568-0.068359-0.24805-0.00794-0.13769 0.033086-0.382 0.082031-0.47656 0.05983-0.1157 0.19357-0.23607 0.33594-0.30274 0.12778-0.05984 0.15159-0.06438 0.32812-0.06445 0.17666-4.2e-5 0.19887 0.0048 0.31641 0.0625 0.069619 0.03439 0.14914 0.08747 0.17578 0.11914 0.15766 0.18731 0.14829 0.69932-0.015625 0.86328-0.03363 0.03363-0.097501 0.07238-0.14062 0.08398-0.073931 0.02003-0.077825 0.02557-0.089844 0.10547-0.026461 0.17658 0.031294 0.31056 0.17578 0.40625 0.23176 0.15353 0.49953 0.11787 0.76758-0.10156 0.21302-0.17438 0.36121-0.39713 0.47266-0.71289 0.04292-0.1217 0.044696-0.13646 0.050781-1.1289 0.0034-0.55325-6.57e-4 -1.2219-0.00977-1.4844-0.01776-0.52256-0.016033-0.50824-0.14843-0.64063-0.094029-0.094039-0.18756-0.13649-0.41992-0.19141-0.37202-0.08787-0.46115-0.15292-0.46094-0.32617 7.19e-5 -0.068527 0.01102-0.106 0.044922-0.14844z\\\"/>\\n </g>\\n</svg>\\n\";","import { LabIcon } from '@jupyterlab/ui-components';\n\nimport JYG from '../style/img/logo.svg';\n\nexport const logo = new LabIcon({ name: 'jyg:logo', svgstr: JYG });\nexport const danger = new LabIcon({\n  name: 'jyg:danger',\n  svgstr: JYG.replace('jp-icon3', 'jp-error-color1'),\n});\n","import { JupyterFrontEnd } from '@jupyterlab/application';\nimport type { LabIcon } from '@jupyterlab/ui-components';\nimport { JSONExt } from '@lumino/coreutils';\n\nconst { emptyObject } = JSONExt;\n\nconst emptyString = Object.freeze('');\n\nimport * as M from './_msgV0';\nimport {\n  IRemoteCommandManager,\n  IRemoteCommandSource,\n  INFO_METHODS,\n  EMOJI,\n} from './tokens';\n\nexport interface IOptions {\n  app: JupyterFrontEnd;\n}\n\nexport class RemoteCommandManager implements IRemoteCommandManager {\n  protected _app: JupyterFrontEnd;\n  protected _sources = new Map<string, IRemoteCommandSource>();\n  protected _commandsInfo: M.CommandsInfo = {};\n  protected _skipCommandMethod = new Map<[string, string], boolean>();\n\n  constructor(options: IOptions) {\n    this._app = options.app;\n    this._initialize().catch(this.onInitFail);\n  }\n\n  /* istanbul ignore next */\n  protected onInitFail = (error: any) => {\n    console.error(EMOJI, `failed to initialize`, error);\n  };\n\n  protected async _initialize() {\n    await this._app.started;\n  }\n\n  public addSource(id: string, source: IRemoteCommandSource) {\n    /* istanbul ignore if */\n    if (this._sources.has(id)) {\n      throw new Error(`${id} source already registered`);\n    }\n    this._sources.set(id, source);\n  }\n\n  public getAppInfo = async (): Promise<M.AppInfo> => {\n    const commands = await this.getCommandsInfo();\n    const appInfo = {\n      url: `${window.location.origin}${window.location.pathname}`,\n      version: this._app.version,\n      plugins: this._app.listPlugins(),\n      name: this._app.name,\n      title: document.title,\n      commands,\n    };\n    return appInfo;\n  };\n\n  public run = async (commandId: string, args?: any): Promise<any> => {\n    return await this._app.commands.execute(commandId, args);\n  };\n\n  public async getCommandsInfo(): Promise<M.CommandsInfo> {\n    const { commands } = this._app;\n    const commandsInfo: M.CommandsInfo = {};\n\n    for (const id of commands.listCommands()) {\n      const info: M.CommandInfo = (commandsInfo[id] = {});\n      for (const method of INFO_METHODS) {\n        if (this._skipCommandMethod.get([id, method])) {\n          continue;\n        }\n        let value: any = null;\n        try {\n          value = commands[method](id, emptyObject) as any;\n        } catch (error) {\n          this._skipCommandMethod.set([id, method], true);\n          continue;\n        }\n\n        switch (value) {\n          case null:\n          case undefined:\n          case emptyObject:\n          case emptyString:\n            continue;\n          default:\n            break;\n        }\n\n        switch (method) {\n          case 'isToggled':\n          case 'isToggleable':\n          case 'isVisible':\n          case 'isEnabled':\n            if (value == false) {\n              continue;\n            }\n            break;\n          case 'mnemonic':\n            if (value == -1) {\n              continue;\n            }\n            break;\n          case 'dataset':\n            if (!Object.keys(value).length) {\n              continue;\n            }\n            break;\n          case 'icon':\n            if ((value as LabIcon).svgstr) {\n              value = value.svgstr;\n            }\n            break;\n          default:\n            break;\n        }\n\n        info[method] = value;\n      }\n    }\n    return commandsInfo;\n  }\n}\n","import { PromiseDelegate } from '@lumino/coreutils';\n\nimport { DEBUG, EMOJI, IRemoteCommandManager } from '../tokens';\nimport * as M from '../_msgV0';\n\nexport interface IOptions {\n  remoteCommands: IRemoteCommandManager;\n}\n\nexport class BaseCommandSource<T extends any = any, U extends IOptions = any> {\n  protected _remoteCommands: IRemoteCommandManager;\n  protected _client: T | null = null;\n  protected _ready = new PromiseDelegate<void>();\n\n  constructor(options: U) {\n    this._remoteCommands = options.remoteCommands;\n  }\n\n  async initialize(options: U): Promise<void> {\n    this._client = await this.initClient(options);\n  }\n\n  /* istanbul ignore next */\n  protected async initClient(options: U): Promise<T> {\n    return null as any;\n  }\n\n  protected onRequest = async (request: M.AnyRequest, source: T): Promise<any> => {\n    await this._ready;\n    /* istanbul ignore next */\n    DEBUG && console.warn(EMOJI, 'message received', request);\n    let responseContent: any;\n    let error: any = null;\n    const { request_id, request_type } = request;\n    const header = { request_id, request_type };\n\n    switch (request_type) {\n      case 'app_info':\n        responseContent = await this._remoteCommands.getAppInfo();\n        break;\n      case 'run':\n        try {\n          responseContent = await this._remoteCommands.run(\n            request.content.id,\n            request.content.args || {}\n          );\n        } catch (err) {\n          error = err;\n        }\n        break;\n      /* istanbul ignore next */\n      default:\n        console.warn(EMOJI, 'unexpected request', request);\n        return {};\n    }\n\n    try {\n      if (error) {\n        await this.sendError({ error: `${error}`, ...header }, source);\n      } else {\n        await this.sendResponse({ content: responseContent, ...header } as any, source);\n      }\n    } catch (err) {\n      await this.sendError(\n        { error: `multiple errors\\n${err}\\n${error}`, ...header },\n        source\n      );\n    }\n  };\n\n  /* istanbul ignore next */\n  protected async sendError(error: M.ErrorResponse, source: T): Promise<void> {\n    // nothing here\n  }\n\n  /* istanbul ignore next */\n  protected async sendResponse(response: M.AnyValidResponse, source: T): Promise<void> {\n    // nothing here\n  }\n}\n","import { URLExt, PageConfig } from '@jupyterlab/coreutils';\nimport { ServerConnection } from '@jupyterlab/services';\nimport { PromiseDelegate } from '@lumino/coreutils';\n\nimport * as M from '../_msgV0';\nimport { EMOJI, IRemoteCommandManager, IRemoteCommandSource } from '../tokens';\n\nimport { BaseCommandSource } from './_base';\n\nexport const API_URL = URLExt.join(PageConfig.getBaseUrl(), 'jyg');\nexport const WS_URL = URLExt.join(API_URL, 'ws').replace(/^http/, 'ws');\n\nexport interface IOptions {\n  serverSettings: ServerConnection.ISettings;\n  remoteCommands: IRemoteCommandManager;\n}\n\nexport class WebSocketCommandSource\n  extends BaseCommandSource<WebSocket>\n  implements IRemoteCommandSource\n{\n  protected _ready = new PromiseDelegate<void>();\n\n  async initClient(options: IOptions): Promise<WebSocket> {\n    const ws = new options.serverSettings.WebSocket(WS_URL);\n    ws.onopen = () => this._ready.resolve();\n    ws.onmessage = this.onMessage;\n    ws.onclose = this.onClose;\n    ws.onerror = this.onError;\n    return ws;\n  }\n\n  protected onMessage = async (ev: MessageEvent<any>): Promise<void> => {\n    this.onRequest(JSON.parse(ev.data), this._client!).catch(this.onError);\n  };\n\n  async sendResponse(response: M.AnyResponse): Promise<void> {\n    this._client!.send(JSON.stringify(response));\n  }\n\n  async sendError(error: M.ErrorResponse): Promise<void> {\n    this._client!.send(JSON.stringify(error));\n  }\n\n  /* istanbul ignore next */\n  protected onClose = async (ev: Event) => {\n    console.warn(EMOJI, 'websocket was closed', ev);\n  };\n\n  /* istanbul ignore next */\n  protected onError = async (ev: Event) => {\n    console.error(EMOJI, 'encountered a websocket error', ev);\n  };\n}\n","import { ISettingRegistry } from '@jupyterlab/settingregistry';\n\nimport * as M from '../_msgV0';\nimport * as P from '../_windowProxy';\nimport { IWindowProxyCommandSource, IRemoteCommandSource, EMOJI } from '../tokens';\n\nimport { BaseCommandSource, IOptions as _IOptions } from './_base';\n\nexport interface IOptions extends _IOptions {\n  appReady: Promise<void>;\n}\n\nexport class WindowProxyCommandSource\n  extends BaseCommandSource<WindowProxy | Worker>\n  implements IRemoteCommandSource, IWindowProxyCommandSource\n{\n  protected _sources: (WindowProxy | Worker)[] = [];\n  protected _listening = false;\n  protected _settings: ISettingRegistry.ISettings | null = null;\n\n  async initClient(options: IOptions): Promise<any> {\n    await options.appReady;\n    return null;\n  }\n\n  set settings(settings: ISettingRegistry.ISettings) {\n    if (this._settings) {\n      throw new Error('already has settings');\n    }\n    this._settings = settings;\n    settings.changed.connect(this.onSettingsChanged, this);\n    this.onSettingsChanged();\n  }\n\n  onSettingsChanged(): void {\n    if (this._settings?.composite.enabled && this._listening) {\n      this.unlisten();\n    }\n  }\n\n  listen() {\n    if (this.composite.enabled) {\n      window.addEventListener('message', this.onSourceMessage);\n      this._listening = true;\n    }\n  }\n\n  unlisten() {\n    window.removeEventListener('message', this.onSourceMessage);\n    this._listening = false;\n    this._sources = [];\n  }\n\n  addSource(source: WindowProxy | Worker, origin: string): void {\n    const allowedSource = this.isAllowedSource(source as any, origin);\n\n    if (allowedSource) {\n      this._sources.push(allowedSource);\n\n      if (!this._listening) {\n        this.listen();\n      }\n    }\n  }\n\n  removeSource(source: WindowProxy | Worker): void {\n    const i = this._sources.indexOf(source);\n    if (i != -1) {\n      this._sources = this._sources.splice(i, 1);\n    }\n    if (!this._sources.length) {\n      this.unlisten();\n    }\n  }\n\n  protected onSourceMessage = async (ev: MessageEvent<any>): Promise<void> => {\n    if (!this.composite.enabled) {\n      this.unlisten();\n      return;\n    }\n\n    const { source, origin } = ev;\n    const allowedSource = this.isAllowedSource(source, origin);\n    if (allowedSource) {\n      this.onRequest(JSON.parse(ev.data), allowedSource).catch(this.onError);\n    }\n  };\n\n  get composite(): P.RemoteCommandsWindow {\n    return (this._settings?.composite || {}) as P.RemoteCommandsWindow;\n  }\n\n  isAllowedSource(\n    source: MessageEventSource | null,\n    origin: string\n  ): WindowProxy | null {\n    if (!(this.composite.enabled && source)) {\n      return null;\n    }\n\n    const { composite } = this;\n\n    if (composite.allow_same_origin && origin == window.origin) {\n      return source as WindowProxy;\n    }\n\n    if (composite.allowed_origins && composite.allowed_origins.includes(origin)) {\n      return source as WindowProxy;\n    }\n\n    return null;\n  }\n\n  async sendResponse(\n    response: M.AnyResponse,\n    source: WindowProxy | Worker\n  ): Promise<void> {\n    source.postMessage(JSON.stringify(response));\n  }\n\n  async sendError(error: M.ErrorResponse, source: WindowProxy | Worker): Promise<void> {\n    source.postMessage(JSON.stringify(error));\n  }\n\n  async onError(error: any) {\n    console.error(EMOJI, 'encountered an error', error);\n  }\n}\n","import { Token } from '@lumino/coreutils';\nimport { ISignal } from '@lumino/signaling';\n\nimport * as _PACKAGE from '../package.json';\n\nexport const PACKAGE = _PACKAGE;\n\nimport * as B from './_boards';\nimport * as M from './_msgV0';\n\nexport const NS = PACKAGE.name;\nexport const VERSION = PACKAGE.version;\nexport const PLUGIN_ID = `${NS}:plugin`;\n\nexport const IRemoteCommandManager = new Token<IRemoteCommandManager>(\n  `${NS}:IRemoteCommandManager`\n);\n\nexport const IWindowProxyCommandSource = new Token<IWindowProxyCommandSource>(\n  `${NS}:IWindowProxyCommandSource`\n);\n\nexport const IBoardManager = new Token<IBoardManager>(`${NS}:IBoardManager`);\n\nexport interface IWindowProxyCommandSource {\n  addSource(source: WindowProxy | Worker, origin: string): void;\n  removeSource(source: WindowProxy | Worker): void;\n}\n\nexport interface IRemoteCommandManager {\n  addSource(id: string, options: IRemoteCommandSource): void;\n  getAppInfo(): Promise<M.AppInfo>;\n  run(commandId: string, args: any): Promise<any>;\n}\n\nexport interface IBoardManager {\n  openBoard(id: string): Promise<void>;\n  boardsChanged: ISignal<IBoardManager, void>;\n  boardIds: string[];\n  getBoard(id: string): B.CommandBoard | null;\n}\n\nexport interface IRemoteCommandSource {\n  // nothing here yet\n}\n\nexport const DEBUG = window.location.href.includes('JYG_DEBUG');\n\n// TODO: make this configurable?\nexport const INFO_METHODS: (keyof M.CommandInfo)[] = [\n  'caption',\n  'className',\n  'dataset',\n  'icon',\n  'iconClass',\n  'iconLabel',\n  'isEnabled',\n  'isToggleable',\n  'isToggled',\n  'isVisible',\n  'label',\n  'mnemonic',\n  'usage',\n];\n\nexport const EMOJI = 'ðŸ“º';\n\nexport const CommandIds = {\n  openBoard: 'jyg:open-board',\n  closeAllBoards: 'jyg:close-all-boards',\n};\n\nexport const CSS = {\n  frame: 'jp-Jyg-Frame',\n  switchArea: 'jp-Jyg-SwitchArea',\n  // lab\n  htmlSelect: 'jp-HTMLSelect',\n  defaultStyle: 'jp-DefaultStyle',\n};\n"],"names":["LabIcon","name","svgstr","danger","emptyObject","JSONExt","emptyString","Object","freeze","RemoteCommandManager","constructor","options","_sources","Map","_commandsInfo","_skipCommandMethod","onInitFail","error","console","getAppInfo","async","commands","this","getCommandsInfo","url","window","location","origin","pathname","version","_app","plugins","listPlugins","title","document","run","commandId","args","execute","app","_initialize","catch","started","addSource","id","source","has","Error","set","commandsInfo","listCommands","info","method","get","value","undefined","keys","length","BaseCommandSource","_client","_ready","PromiseDelegate","onRequest","request","responseContent","warn","request_id","request_type","header","_remoteCommands","content","err","sendError","sendResponse","remoteCommands","initClient","response","API_URL","URLExt","PageConfig","WS_URL","replace","WebSocketCommandSource","onMessage","ev","JSON","parse","data","onError","onClose","ws","serverSettings","WebSocket","onopen","resolve","onmessage","onclose","onerror","send","stringify","WindowProxyCommandSource","_listening","_settings","onSourceMessage","composite","enabled","unlisten","allowedSource","isAllowedSource","appReady","settings","changed","connect","onSettingsChanged","listen","addEventListener","removeEventListener","push","removeSource","i","indexOf","splice","allow_same_origin","allowed_origins","includes","postMessage","PACKAGE","NS","VERSION","PLUGIN_ID","IRemoteCommandManager","Token","IWindowProxyCommandSource","IBoardManager","DEBUG","href","INFO_METHODS","EMOJI","CommandIds","openBoard","closeAllBoards","CSS","frame","switchArea","htmlSelect","defaultStyle"],"sourceRoot":""}