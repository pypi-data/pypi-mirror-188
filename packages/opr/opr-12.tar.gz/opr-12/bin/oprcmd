#!/usr/bin/env python3
# This file is placed in the Public Domain.
# pylint: disable=C0114,C0115,C0116,C0413,R0801


"write your own commands"


import sys ; sys.path.insert(0, ".")


import inspect
import os
import sys


from opr.handler import Command, Handler
from opr.objects import Wd
from opr.runtime import Cfg, command, parse
from opr.scanner import scan


Cfg.name = "opr"
Wd.workdir = os.path.expanduser("~/.opr")


class CLI(Handler):

    @staticmethod
    def raw(txt):
        print(txt)
        sys.stdout.flush()


def mod(event):
    path = operbot.__path__[0]
    event.reply(",".join([x[:-3] for x in os.listdir(path) if not (x.startswith("_") or x.endswith("~"))]))


def main():
    Command.add(mod)
    scanpkg(opr.modules)
    parse(' '.join(sys.argv[1:]))
    cli = CLI()
    command(cli, Cfg.prs.otxt)
    

main()
