# tox (https://tox.readthedocs.io/) is a tool for running tests
# in multiple virtualenvs. This configuration file will run the
# test suite on all supported python versions. To use it, "pip install tox"
# and then run "tox" from this directory.

[tox]
envlist = tests-py{36,37,38}-{nix,win},nbmake,post-release-check
minversion = 3.7
skipsdist = true
skip_install = true

[testenv:nbmake]
recreate = false
passenv = DESKTOP_APP_KEY EDP_USERNAME EDP_PASSWORD USERNAME PASSWORD
setenv =
    APP_KEY = {env:DESKTOP_APP_KEY}
    RDP_LOGIN = {env:EDP_USERNAME}
    RDP_PASSWORD = {env:EDP_PASSWORD}
    YOUR_APP_KEY = {env:DESKTOP_APP_KEY}
    YOUR_REFINITIV_DATA_PLATFORM_LOGIN = {env:EDP_USERNAME}
    YOUR_REFINITIV_DATA_PLATFORM_PASSWORD = {env:EDP_PASSWORD}
    USERNAME = {env:USERNAME}
    PASSWORD = {env:PASSWORD}
    RD_VERSION = {env:RD_VERSION}
deps =
    pytest
    nbmake
changedir = ./notebook/public/
commands =
    - python -m pip install --extra-index-url https://{env:USERNAME}:{env:PASSWORD}@bams-aws.refinitiv.com/artifactory/api/pypi/default.pypi.cloud/simple refinitiv-data=={env:RD_VERSION}
    - python -m pytest --nbmake "./"
