{"version":3,"file":"chunks/app_components_events_eventReplay_replayPreview_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"q+BAwBA,SAASA,EAAc,GAAqC,IAArC,QAACC,EAAO,WAAEC,EAAU,MAAEC,GAAa,EACxD,MAAMC,GAASC,EAAAA,EAAAA,MACT,SAACC,EAAQ,OAAEC,EAAM,WAAEC,IAAcC,EAAAA,EAAAA,GAAc,CACnDR,UACAC,eAEIQ,EAAiBP,EAAMQ,YACkC,IAA3DC,KAAKC,MAAM,IAAIC,KAAKX,EAAMQ,aAAaI,UAAY,KACnD,EAEEC,EAAeT,GAAQU,YAEvBC,EAAmBF,GAAcG,WAAWJ,WAAa,EAEzDK,GAAoBC,EAAAA,EAAAA,UAAQ,IAC5BX,GAAkBQ,GACbI,EAAAA,EAAAA,IAAiBZ,EAAgBQ,GAAoB,IAGvD,GACN,CAACR,EAAgBQ,IAEpB,GAAIV,EACF,OACE,QAAC,KAAK,CAACe,KAAK,OAAOC,UAAQ,EAAC,eAAa,eAAc,UACpDC,EAAAA,EAAAA,GAAE,+DAKT,GAAInB,IAAaU,EACf,OACE,QAACU,EAAiB,CAChBC,OAAO,6BACPC,OAAO,QACPC,MAAM,SAKZ,MAAMC,EAAgB,CACpBC,SAAW,kBAAiB9B,aAAmBC,KAC/C8B,MAAO,CACLC,UAAUC,EAAAA,EAAAA,GAAyB9B,GACnC+B,OAAQ,UACRV,EAAGL,IAIP,OACE,QAAC,IAAqB,CAACb,OAAQA,EAAQa,kBAAmBA,EAAkB,UAC1E,QAACgB,EAAe,CAAC,eAAa,mBAAkB,WAC9C,QAACC,EAAW,WACV,QAAC,IAAY,CAACC,WAAS,OAEzB,QAACC,EAAU,WACT,QAAC,KAAM,CAACC,SAAS,UAAUC,GAAIX,EAAc,UAC1CL,EAAAA,EAAAA,GAAE,oBAGP,QAACiB,EAAc,YACb,QAACC,EAAW,WAAElB,EAAAA,EAAAA,GAAE,cAChB,QAAC,IAAmB,WAK9B,CAnESzB,EAAa,4BAqEtB,MAAMoC,GAAkB,OAAOQ,EAAAA,EAAW,oBAAlB,CAAmB,oCAExBC,EAAAA,EAAAA,GAAM,GAAE,gBACXC,GAAKA,EAAEC,MAAMC,YAAU,SAC9BH,EAAAA,EAAAA,GAAM,GAAE,sBAIXR,GAAc,OAAOO,EAAAA,EAAW,oBAAlB,CAAmB,qBACjBE,GAAKA,EAAEC,MAAME,QAAM,mBACtBH,GAAKA,EAAEC,MAAMG,cAAY,KAGtCX,GAAa,OAAO,MAAK,oBAAZ,CAAa,8JAU1BG,GAAiB,OAAO,MAAK,oBAAZ,CAAa,0DAI3BG,EAAAA,EAAAA,GAAM,GAAE,WACNA,EAAAA,EAAAA,GAAM,GAAE,gBACHC,GAAKA,EAAEC,MAAMC,YAAU,mCAE1BH,EAAAA,EAAAA,GAAM,KAAK,KAAIA,EAAAA,EAAAA,GAAM,KAAK,KAAIA,EAAAA,EAAAA,GAAM,KAAK,KAAIA,EAAAA,EAAAA,GAAM,GAAE,gBAClDC,GAAKA,EAAEC,MAAMI,iBAAe,WACjCN,EAAAA,EAAAA,GAAM,KAAK,KAGhBF,GAAc,OAAO,MAAK,oBAAZ,CAAa,cAClBG,GAAKA,EAAEC,MAAMK,eAAa,yBAE9BN,GAAKA,EAAEC,MAAMM,MAAI,KAGtB3B,GAAoB,OAAO4B,EAAAA,EAAW,oBAAlB,CAAmB,kBAC1BT,EAAAA,EAAAA,GAAM,GAAE,KAG3B,G","sources":["webpack:///./app/components/events/eventReplay/replayPreview.tsx"],"sourcesContent":["import {useMemo} from 'react';\nimport styled from '@emotion/styled';\n\nimport {Alert} from 'sentry/components/alert';\nimport {Button} from 'sentry/components/button';\nimport Placeholder from 'sentry/components/placeholder';\nimport {Provider as ReplayContextProvider} from 'sentry/components/replays/replayContext';\nimport ReplayPlayer from 'sentry/components/replays/replayPlayer';\nimport ReplaysFeatureBadge from 'sentry/components/replays/replaysFeatureBadge';\nimport {relativeTimeInMs} from 'sentry/components/replays/utils';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {Event} from 'sentry/types/event';\nimport getRouteStringFromRoutes from 'sentry/utils/getRouteStringFromRoutes';\nimport useReplayData from 'sentry/utils/replays/hooks/useReplayData';\nimport {useRoutes} from 'sentry/utils/useRoutes';\nimport FluidHeight from 'sentry/views/replays/detail/layout/fluidHeight';\n\ntype Props = {\n  event: Event;\n  orgSlug: string;\n  replaySlug: string;\n};\n\nfunction ReplayContent({orgSlug, replaySlug, event}: Props) {\n  const routes = useRoutes();\n  const {fetching, replay, fetchError} = useReplayData({\n    orgSlug,\n    replaySlug,\n  });\n  const eventTimestamp = event.dateCreated\n    ? Math.floor(new Date(event.dateCreated).getTime() / 1000) * 1000\n    : 0;\n\n  const replayRecord = replay?.getReplay();\n\n  const startTimestampMs = replayRecord?.started_at.getTime() ?? 0;\n\n  const initialTimeOffset = useMemo(() => {\n    if (eventTimestamp && startTimestampMs) {\n      return relativeTimeInMs(eventTimestamp, startTimestampMs) / 1000;\n    }\n\n    return 0;\n  }, [eventTimestamp, startTimestampMs]);\n\n  if (fetchError) {\n    return (\n      <Alert type=\"info\" showIcon data-test-id=\"replay-error\">\n        {t('The replay associated with this event could not be found.')}\n      </Alert>\n    );\n  }\n\n  if (fetching || !replayRecord) {\n    return (\n      <StyledPlaceholder\n        testId=\"replay-loading-placeholder\"\n        height=\"400px\"\n        width=\"100%\"\n      />\n    );\n  }\n\n  const fullReplayUrl = {\n    pathname: `/organizations/${orgSlug}/replays/${replaySlug}/`,\n    query: {\n      referrer: getRouteStringFromRoutes(routes),\n      t_main: 'console',\n      t: initialTimeOffset,\n    },\n  };\n\n  return (\n    <ReplayContextProvider replay={replay} initialTimeOffset={initialTimeOffset}>\n      <PlayerContainer data-test-id=\"player-container\">\n        <StaticPanel>\n          <ReplayPlayer isPreview />\n        </StaticPanel>\n        <CTAOverlay>\n          <Button priority=\"primary\" to={fullReplayUrl}>\n            {t('Open Replay')}\n          </Button>\n        </CTAOverlay>\n        <BadgeContainer>\n          <FeatureText>{t('Replays')}</FeatureText>\n          <ReplaysFeatureBadge />\n        </BadgeContainer>\n      </PlayerContainer>\n    </ReplayContextProvider>\n  );\n}\n\nconst PlayerContainer = styled(FluidHeight)`\n  position: relative;\n  margin-bottom: ${space(2)};\n  background: ${p => p.theme.background};\n  gap: ${space(1)};\n  max-height: 448px;\n`;\n\nconst StaticPanel = styled(FluidHeight)`\n  border: 1px solid ${p => p.theme.border};\n  border-radius: ${p => p.theme.borderRadius};\n`;\n\nconst CTAOverlay = styled('div')`\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: rgba(255, 255, 255, 0.5);\n`;\n\nconst BadgeContainer = styled('div')`\n  display: flex;\n  align-items: center;\n  position: absolute;\n  top: ${space(1)};\n  right: ${space(1)};\n  background: ${p => p.theme.background};\n  border-radius: 2.25rem;\n  padding: ${space(0.75)} ${space(0.75)} ${space(0.75)} ${space(1)};\n  box-shadow: ${p => p.theme.dropShadowLight};\n  gap: 0 ${space(0.25)};\n`;\n\nconst FeatureText = styled('div')`\n  font-size: ${p => p.theme.fontSizeSmall};\n  line-height: 0;\n  color: ${p => p.theme.text};\n`;\n\nconst StyledPlaceholder = styled(Placeholder)`\n  margin-bottom: ${space(2)};\n`;\n\nexport default ReplayContent;\n"],"names":["ReplayContent","orgSlug","replaySlug","event","routes","useRoutes","fetching","replay","fetchError","useReplayData","eventTimestamp","dateCreated","Math","floor","Date","getTime","replayRecord","getReplay","startTimestampMs","started_at","initialTimeOffset","useMemo","relativeTimeInMs","type","showIcon","t","StyledPlaceholder","testId","height","width","fullReplayUrl","pathname","query","referrer","getRouteStringFromRoutes","t_main","PlayerContainer","StaticPanel","isPreview","CTAOverlay","priority","to","BadgeContainer","FeatureText","FluidHeight","space","p","theme","background","border","borderRadius","dropShadowLight","fontSizeSmall","text","Placeholder"],"sourceRoot":""}