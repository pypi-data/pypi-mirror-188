"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_profiling_profileGroupProvider_tsx"],{"./app/components/profiling/profilingBreadcrumbs.tsx":(e,t,r)=>{r.d(t,{u:()=>d}),r("../node_modules/core-js/modules/es.error.cause.js");var n=r("../node_modules/react/index.js"),s=r("../node_modules/lodash/omit.js"),i=r.n(s),o=r("./app/components/breadcrumbs.tsx"),a=r("./app/locale.tsx"),l=r("./app/utils/profiling/routes.tsx"),u=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{organization:t,trails:r}=e;const s=(0,n.useMemo)((()=>r.map((e=>function(e,t){let{organization:r}=t;switch(e.type){case"landing":return{to:(0,l.XR)({query:i()(e.payload.query,["cursor","query"]),orgSlug:r.slug}),label:(0,a.t)("Profiling"),preservePageFilters:!0};case"profile summary":return{to:(0,l.R0)({query:i()(e.payload.query,["cursor","query"]),orgSlug:r.slug,projectSlug:e.payload.projectSlug,transaction:e.payload.transaction}),label:(0,a.t)("Profile Summary"),preservePageFilters:!0};case"flamechart":return{to:("flamechart"===e.payload.tab?l.TH:l.Qy)({query:e.payload.query,orgSlug:r.slug,projectSlug:e.payload.projectSlug,profileId:e.payload.profileId}),label:e.payload.transaction,preservePageFilters:!0};default:throw new Error(`Unknown breadcrumb type: ${JSON.stringify(e)}`)}}(e,{organization:t})))),[t,r]);return(0,u.tZ)(o.Z,{crumbs:s})}d.displayName="ProfilingBreadcrumbs"},"./app/utils/profiling/callTreeNode.tsx":(e,t,r)=>{r.d(t,{n:()=>o});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./app/utils/profiling/frame.tsx"),i=r("./app/utils/profiling/weightedNode.tsx");class o extends i.${constructor(e,t){super(),(0,n.Z)(this,"frame",void 0),(0,n.Z)(this,"locked",!1),(0,n.Z)(this,"parent",void 0),(0,n.Z)(this,"recursive",void 0),(0,n.Z)(this,"children",[]),this.recursive=null,this.parent=t,this.frame=e}setParent(e){this.parent=e}setRecursiveThroughNode(e){this.recursive=e}isRecursive(){return!!this.recursive}isDirectRecursive(){return!!this.parent&&this.parent.frame===this.frame}isLocked(){return this.locked}lock(){this.locked=!0}isRoot(){return s.R.Root.name===this.frame.name}}(0,n.Z)(o,"Root",new o(s.R.Root,null))},"./app/utils/profiling/frame.tsx":(e,t,r)=>{r.d(t,{R:()=>o});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./app/locale.tsx"),i=r("./app/utils/profiling/weightedNode.tsx");class o extends i.${constructor(e,t){if(super(),(0,n.Z)(this,"key",void 0),(0,n.Z)(this,"name",void 0),(0,n.Z)(this,"file",void 0),(0,n.Z)(this,"line",void 0),(0,n.Z)(this,"column",void 0),(0,n.Z)(this,"is_application",void 0),(0,n.Z)(this,"path",void 0),(0,n.Z)(this,"image",void 0),(0,n.Z)(this,"resource",void 0),(0,n.Z)(this,"threadId",void 0),(0,n.Z)(this,"inline",void 0),this.key=e.key,this.file=e.file,this.name=e.name,this.resource=e.resource,this.line=e.line,this.column=e.column,this.is_application=!!e.is_application,this.image=e.image,this.threadId=e.threadId,this.path=e.path,e.columnNumber&&void 0===this.column&&(this.column=e.columnNumber),e.lineNumber&&void 0===this.column&&(this.line=e.lineNumber),e.scriptName&&void 0===this.column&&(this.resource=e.scriptName),"web"===t||"node"===t){"(garbage collector)"!==this.name&&"(root)"!==this.name||(this.is_application=!1),this.name&&!this.name.startsWith("unknown ")||(this.name=(0,s.t)("<anonymous>")),void 0===this.line&&void 0===this.column&&(this.name+=` ${(0,s.t)("[native code]")}`,this.is_application=!1);const e=this.path||this.file;if(e){if(e.startsWith("node:internal")&&(this.is_application=!1),void 0===this.image&&e){const t=/node_modules(\/|\\)(?<maybeScopeOrPackage>.*?)(\/|\\)((?<maybePackage>.*)((\/|\\)))?/.exec(e);if(t?.groups){const{maybeScopeOrPackage:e,maybePackage:r}=t.groups;e.startsWith("@")?this.image=`${e}/${r}`:this.image=t.groups.maybeScopeOrPackage,this.is_application=!1}}if("node:"===e?.substring(0,5)){let t="";const r=e.length;for(let n=0;n<r;n++){if("/"===e.charAt(n)){for(t+="/",n++;n<r&&"/"!==e.charAt(n);)t+=e.charAt(n),n++;break}t+=e.charAt(n)}this.image=t}}}this.name||(this.name=(0,s.t)("<unknown>"))}isRoot(){return this.name===o.Root.name}}(0,n.Z)(o,"Root",new o({key:"sentry root",name:"sentry root",is_application:!1},"mobile"))},"./app/utils/profiling/profile/importProfile.tsx":(e,t,r)=>{r.d(t,{T:()=>F,B:()=>_}),r("../node_modules/core-js/modules/es.error.cause.js"),r("../node_modules/core-js/modules/es.array.push.js");var n=r("../node_modules/@sentry/core/esm/exports.js");function s(e){return!("type"in e)&&Array.isArray(e.resources)}function i(e){return"object"==typeof e&&"traceEvents"in e}function o(e){return Array.isArray(e)&&!e.some((e=>"P"===e.ph&&"ProfileChunk"===e.name))}var a=r("./app/utils/profiling/frame.tsx"),l=r("./app/utils/profiling/profile/utils.tsx"),u=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=(r("../node_modules/core-js/modules/es.array.at.js"),r("../node_modules/core-js/modules/es.string.at-alternative.js"),r("./app/utils.tsx")),p=r("./app/utils/profiling/callTreeNode.tsx"),c=r("./app/utils/profiling/profile/profile.tsx");class h extends c.N{constructor(){super(...arguments),(0,u.Z)(this,"appendOrderStack",[this.appendOrderTree]),(0,u.Z)(this,"stack",[]),(0,u.Z)(this,"lastValue",0)}static FromProfile(e,t){const r=new h({duration:e.endValue-e.startValue,startedAt:e.startValue,endedAt:e.endValue,name:e.name,unit:e.unit,threadId:e.threadID});r.lastValue=Math.max(0,e.startValue);for(const n of e.events){const e=t[n.frame];if(!e)throw new Error(`Cannot retrieve event: ${n.frame} from frame index`);switch(n.type){case"O":r.enterFrame(e,n.at);break;case"C":r.leaveFrame(e,n.at);break;default:throw new TypeError(`Unknown event type ${n.type}`)}}return r.build()}addWeightToFrames(e){const t=e-this.lastValue;for(const e of this.stack)e.addToTotalWeight(t);const r=(0,d.SI)(this.stack);r&&r.addToSelfWeight(e)}addWeightsToNodes(e){const t=e-this.lastValue;for(const e of this.appendOrderStack)e.addToTotalWeight(t);const r=(0,d.SI)(this.appendOrderStack);r&&r.addToSelfWeight(t)}enterFrame(e,t){this.addWeightToFrames(t),this.addWeightsToNodes(t);const r=(0,d.SI)(this.appendOrderStack);if(r){const n=t-this.lastValue;if(n<0)throw new Error("Sample delta cannot be negative, samples may be corrupt or out of order");n>0&&(this.samples.push(r),this.weights.push(n));const s=(0,d.SI)(r.children);let i;s&&!s.isLocked()&&s.frame===e?i=s:(i=new p.n(e,r),r.children.push(i));let o=this.appendOrderStack.length-1;for(;o>=0;){if(this.appendOrderStack[o].frame===i.frame){this.appendOrderStack[o].setRecursiveThroughNode(i),i.setRecursiveThroughNode(this.appendOrderStack[o]);break}o--}this.appendOrderStack.push(i)}this.stack.push(e),this.lastValue=t}leaveFrame(e,t){this.addWeightToFrames(t),this.addWeightsToNodes(t),this.trackSampleStats(t);const r=this.appendOrderStack.pop();if(void 0===r)throw new Error("Unbalanced stack");r.lock();const n=t-this.lastValue;n>0&&(this.samples.push(r),this.weights.push(n),this.minFrameDuration=Math.min(n,this.minFrameDuration)),this.stack.pop(),this.lastValue=t}build(){if(this.appendOrderStack.length>1)throw new Error("Unbalanced append order stack");return this.duration=Math.max(this.duration,this.weights.reduce(((e,t)=>e+t),0)),this.minFrameDuration!==Number.POSITIVE_INFINITY&&0!==this.minFrameDuration||(this.minFrameDuration=this.duration),this}}class m extends h{}function f(e,t){return t.ts-e.ts}function g(e,t){if(!e.length&&!t.length)throw new Error("Profile contains no events");const r=e[e.length-1],n=t[t.length-1];return n?r?r.ts<n.ts?"B":n.ts<r.ts?"E":"B":"E":"B"}function y(e,t,r){let n=`pid (${e})`,s=`tid (${t})`;const i=r.filter((e=>"B"===e.ph||"E"===e.ph||"X"===e.ph||"M"===e.ph)),o=[],l=[];for(let r=0;r<i.length;r++){const a=i[r];if("M"===a.ph){if("thread_name"===a.name&&"string"==typeof a.args.name){s=`${a.args.name} (${t})`;continue}if("process_name"===a.name&&"string"==typeof a.args.name){n=`${a.args.name} (${e})`;continue}}"B"!==a.ph?"E"!==a.ph?"X"!==a.ph||"number"!=typeof a.dur&&"number"!=typeof a.tdur||(o.push({...a,ph:"B"}),l.push({...a,ph:"E",ts:a.ts+(a.dur??a.tdur??0)})):l.push(a):o.push(a)}if(o.sort(f),l.sort(f),!o.length)throw new Error("Profile does not contain any frame events");const u=o[o.length-1].ts,d=l[0]?.ts??o[0].ts;if("number"!=typeof u)throw new Error("First begin event contains no timestamp");if("number"!=typeof d)throw new Error("Last end event contains no timestamp");const p=new m({duration:d-u,startedAt:u,endedAt:d,name:`${n}: ${s}`,unit:"microseconds",threadId:t}),c=[],h=new Map;for(;o.length>0||l.length>0;){const e=g(o,l);if("B"!==e)if("E"!==e);else{const e=l.pop();let t=v(e);if(void 0===c[c.length-1])throw new Error(`Unable to close frame from an empty stack, attempting to close ${JSON.stringify(e)}`);const r=v(c[c.length-1]);for(let e=l.length-2;e>0&&!(l[e].ts>l[l.length-1].ts);e--){const n=v(l[e]);if(r.key===n.key){const r=l[l.length-1];l[l.length-1]=l[e],l[e]=r,t=n;break}}if(!h.has(t.key))throw new Error(`Cannot leave frame that was never entered, leaving ${t.key}`);const n=h.get(t.key);p.leaveFrame(n,e.ts-u),c.pop()}else{const e=o.pop();if(!e)throw new Error("Nothing to take from begin queue");const t=v(e);h.has(t.key)||h.set(t.key,new a.R(t));const r=h.get(t.key);p.enterFrame(r,e.ts-u),c.push(e)}}for(;c.length;){const e=v(c.pop()),t=h.get(e.key);if(!t)throw new Error(`Cannot leave frame that was never entered, leaving ${e.key}`);p.leaveFrame(t,t.totalWeight)}return p.build()}function v(e){const t=JSON.stringify(e.args);return{key:t,name:`${e?.name||"Unknown"} ${t}`.trim()}}var w=r("./app/locale.tsx");function S(e){switch(e){case"gc":return(0,w.t)("Garbage Collection");case"style":return(0,w.t)("Style");case"layout":return(0,w.t)("Layout");case"paint":return(0,w.t)("Paint");case"script":return(0,w.t)("Script");case"other":return(0,w.t)("Other");default:return e}}function I(e){return{name:S(e),resourceId:void 0,line:void 0,column:void 0}}function k(e,t,r,n){const s=[];if(n&&"script"!==n&&s.unshift(new a.R({...I(n),key:n})),void 0===t)return s;let i=e.stacks[t];if(!i)throw new Error(`Missing stackId ${t} in trace, cannot resolve stack`);for(;void 0!==i;){if(void 0===e.frames[i.frameId])return s;s.unshift(r[i.frameId]),i=void 0!==i.parentId?e.stacks[i.parentId]:void 0}return s}r("../node_modules/core-js/modules/es.array.unshift.js");class b extends c.N{static FromProfile(e,t){const r=["gc","layout","other","paint","script","style"];for(const e of r)t[e]=new a.R({key:e,name:S(e),line:void 0,column:void 0,is_application:!1},"web");const n=e.samples[0].timestamp,s=(0,d.SI)(e.samples).timestamp,i=new b({duration:s-n,startedAt:n,endedAt:s,name:"JSSelfProfiling",unit:"milliseconds",threadId:0});i.appendSample(k(e,e.samples[0].stackId,t,e.samples[0].marker),0);for(let r=1;r<e.samples.length;r++)"gc"===e.samples[r].marker?i.appendSample(k(e,e.samples[r-1].stackId,t,e.samples[r].marker),e.samples[r].timestamp-e.samples[r-1].timestamp):i.appendSample(k(e,e.samples[r].stackId,t,e.samples[r].marker),e.samples[r].timestamp-e.samples[r-1].timestamp);return i.build()}appendSample(e,t){this.trackSampleStats(t);let r=this.appendOrderTree;const n=[];for(const s of e){const e=(0,d.SI)(r.children);if(e&&!e.isLocked()&&e.frame===s)r=e;else{const e=r;r=new p.n(s,r),e.children.push(r)}r.addToTotalWeight(t);let i=n.length-1;for(;i>=0;){if(n[i].frame===r.frame){n[i].setRecursiveThroughNode(r),r.setRecursiveThroughNode(n[i]);break}i--}n.push(r)}r.addToSelfWeight(t),t>0&&(this.minFrameDuration=Math.min(t,this.minFrameDuration));for(const e of r.children)e.lock();r.frame.addToSelfWeight(t);for(const e of n)e.frame.addToTotalWeight(t);r===(0,d.SI)(this.samples)?this.weights[this.weights.length-1]+=t:(this.samples.push(r),this.weights.push(t))}build(){return this.duration=Math.max(this.duration,this.weights.reduce(((e,t)=>e+t),0)),this.minFrameDuration!==Number.POSITIVE_INFINITY&&0!==this.minFrameDuration||(this.minFrameDuration=this.duration),this}}class x extends c.N{static FromProfile(e,t){const r=new x({duration:e.endValue-e.startValue,startedAt:e.startValue,endedAt:e.endValue,name:e.name,unit:e.unit,threadId:e.threadID});if(e.samples.length!==e.weights.length)throw new Error(`Expected samples.length (${e.samples.length}) to equal weights.length (${e.weights.length})`);for(let n=0;n<e.samples.length;n++){const s=e.samples[n];let i=e.weights[n],o=s.map((e=>{if(!t[e])throw new Error(`Could not resolve frame ${e} in frame index`);return t[e]}));if(n>0&&o.length<=2&&"(garbage collector) [native code]"===o[o.length-1]?.name)for(o=e.samples[n-1].map((e=>{if(!t[e])throw new Error(`Could not resolve frame ${e} in frame index`);return t[e]})).concat(o[o.length-1]);e.samples[n+1]&&e.samples[n+1].length<=2&&"(garbage collector) [native code]"===t[e.samples[n+1][e.samples[n+1].length-1]]?.name;)i+=e.weights[++n];r.appendSampleWithWeight(o,i)}return r.build()}appendSampleWithWeight(e,t){if(this.trackSampleStats(t),0===t)return;let r=this.appendOrderTree;const n=[];for(const s of e){const e=(0,d.SI)(r.children);if(e&&!e.isLocked()&&e.frame===s)r=e;else{const e=r;r=new p.n(s,r),e.children.push(r)}r.addToTotalWeight(t);let i=n.length-1;for(;i>=0;){if(n[i].frame===r.frame){n[i].setRecursiveThroughNode(r),r.setRecursiveThroughNode(n[i]);break}i--}n.push(r)}r.addToSelfWeight(t),this.minFrameDuration=Math.min(t,this.minFrameDuration);for(const e of r.children)e.lock();r.frame.addToSelfWeight(t);for(const e of n)e.frame.addToTotalWeight(t);r===(0,d.SI)(this.samples)?this.weights[this.weights.length-1]+=t:(this.samples.push(r),this.weights.push(t))}build(){return this.duration=Math.max(this.duration,this.weights.reduce(((e,t)=>e+t),0)),this.minFrameDuration!==Number.POSITIVE_INFINITY&&0!==this.minFrameDuration||(this.minFrameDuration=this.duration),this}}class T extends c.N{static FromProfile(e,t){const{samples:r,stacks:n,thread_metadata:s={}}=e.profile,i=parseInt(r[0].elapsed_since_start_ns,10),o=parseInt(r[r.length-1].elapsed_since_start_ns,10);if(Number.isNaN(i)||Number.isNaN(o))throw TypeError("startedAt or endedAt is NaN");const a=parseInt(r[0].thread_id,10),l=`thread: ${s[r[0].thread_id]?.name||a}`,u=e.transactions?.[0]?.name,d=new T({duration:o-i,startedAt:i,endedAt:o,unit:"nanoseconds",name:u?`${u} (${l})`:l,threadId:a});let p=0;for(let e=0;e<r.length;e++){const s=r[e],i=n[s.stack_id],o=parseInt(s.elapsed_since_start_ns,10);d.appendSampleWithWeight(i.map((e=>{if(!t[e])throw new Error(`Could not resolve frame ${e} in frame index`);return t[e]})),o-p),p=o}return d.build()}appendSampleWithWeight(e,t){if(this.trackSampleStats(t),0===t)return;let r=this.appendOrderTree;const n=[];for(let s=e.length-1;s>=0;s--){const i=e[s],o=(0,d.SI)(r.children);if(o&&!o.isLocked()&&o.frame===i)r=o;else{const e=r;r=new p.n(i,r),e.children.push(r)}r.addToTotalWeight(t);let a=n.length-1;for(;a>=0;){if(n[a].frame===r.frame){n[a].setRecursiveThroughNode(r),r.setRecursiveThroughNode(n[a]);break}a--}n.push(r)}r.addToSelfWeight(t),this.minFrameDuration=Math.min(t,this.minFrameDuration);for(const e of r.children)e.lock();r.frame.addToSelfWeight(t);for(const e of n)e.frame.addToTotalWeight(t);r===(0,d.SI)(this.samples)?this.weights[this.weights.length-1]+=t:(this.samples.push(r),this.weights.push(t))}build(){return this.duration=Math.max(this.duration,this.weights.reduce(((e,t)=>e+t),0)),this.minFrameDuration!==Number.POSITIVE_INFINITY&&0!==this.minFrameDuration||(this.minFrameDuration=this.duration),this}}function _(e,t){const r=n.Yr({op:"import",name:"profiles.import"});try{if(s(e))return r&&r.setTag("profile.type","js-self-profile"),function(e,t,r){const n=P(e,(0,l.vw)("web",e.frames),r);return{traceID:t,name:t,transactionID:null,activeProfileIndex:0,profiles:[n],measurements:{},metadata:{platform:"javascript",durationNS:n.duration}}}(e,t,{transaction:r});if(function(e){return o(e)||i(e)||function(e){return Array.isArray(e)&&e.some((e=>"P"===e.ph&&"ProfileChunk"===e.name))}(e)}(e))return r&&r.setTag("profile.type","chrometrace"),function(e,t,r){if(i(e))throw new Error("Chrometrace object format is not yet supported");if(o(e))return function(e,t,r){const n=[],s=function(e){const t=new Map;for(let r=0;r<e.length;r++){const n=e[r];if("number"!=typeof n.pid)continue;if("number"!=typeof n.tid)continue;let s=t.get(n.pid);s||(s=new Map,t.set(n.pid,s));let i=s.get(n.tid);i||(i=[],s.set(n.tid,i)),i.push(n)}return t}(e);for(const[e,t]of s)for(const[s,i]of t)(0,l.GB)(r?.transaction,(()=>n.push(y(e,s,i??[]))),{op:"profile.import",description:"chrometrace"});return{name:"chrometrace",traceID:t,transactionID:null,activeProfileIndex:0,profiles:n,metadata:{},measurements:{}}}(e,t,r);throw new Error("Failed to parse trace input format")}(e,t,{transaction:r});if(function(e){return"profile"in e&&"samples"in e.profile&&"stacks"in e.profile&&"frames"in e.profile}(e))return r&&r.setTag("profile.type","sentry-sampled"),function(e,t){const r=(0,l.h1)(e.profile.frames),n={};for(let t=0;t<e.profile.samples.length;t++){const r=e.profile.samples[t];n[r.thread_id]||(n[r.thread_id]=[]),n[r.thread_id].push(r)}for(const e in n)n[e].sort(((e,t)=>parseInt(e.elapsed_since_start_ns,10)-parseInt(t.elapsed_since_start_ns,10)));const s=[];for(const i in n){const o={...e,profile:{...e.profile,samples:n[i]}};s.push((0,l.GB)(t.transaction,(()=>T.FromProfile(o,r)),{op:"profile.import",description:"evented"}))}const i=e.transactions?.[0];return{transactionID:i?.id??null,traceID:i?.trace_id??"",name:i?.name??"",activeProfileIndex:0,measurements:{},metadata:{deviceLocale:e.device.locale,deviceManufacturer:e.device.manufacturer,deviceModel:e.device.model,deviceOSName:e.os.name,deviceOSVersion:e.os.version,durationNS:parseInt(e.profile.samples[e.profile.samples.length-1].elapsed_since_start_ns,10),environment:e.environment,platform:e.platform,profileID:e.event_id,transactionID:i?.id,transactionName:i?.name,traceID:i?.trace_id},profiles:s}}(e,{transaction:r});if(function(e){return"object"==typeof e&&"profiles"in e&&Array.isArray(e.profiles)&&"shared"in e}(e))return r&&r.setTag("profile.type","schema"),function(e,t,r){const n=(0,l.vw)("node"===e.metadata.platform?"node":"mobile",e.shared.frames);return{traceID:t,transactionID:e.metadata.transactionID??null,name:e.metadata?.transactionName??t,activeProfileIndex:e.activeProfileIndex??0,metadata:e.metadata??{},measurements:e.measurements??{},profiles:e.profiles.map((e=>P(e,n,r)))}}(e,t,{transaction:r});throw new Error("Unsupported trace format")}catch(e){throw r&&r.setStatus("internal_error"),e}finally{r&&r.finish()}}function P(e,t,r){let{transaction:n}=r;if(function(e){return"type"in e&&"evented"===e.type}(e))return n?(0,l.GB)(n,(()=>h.FromProfile(e,t)),{op:"profile.import",description:"evented"}):h.FromProfile(e,t);if(function(e){return"type"in e&&"sampled"===e.type}(e))return n?(0,l.GB)(n,(()=>x.FromProfile(e,t)),{op:"profile.import",description:"sampled"}):x.FromProfile(e,t);if(s(e))return n?(0,l.GB)(n,(()=>b.FromProfile(e,(0,l.vw)("web",e.frames))),{op:"profile.import",description:"js-self-profile"}):b.FromProfile(e,(0,l.vw)("web",e.frames));throw new Error("Unrecognized trace format")}const N=e=>{try{return[JSON.parse(e),null]}catch(e){return[null,e]}},j=[e=>N(e),e=>N(e+"]")];function Z(e){return new Promise(((t,r)=>{const n=new FileReader;n.addEventListener("load",(e=>{"string"!=typeof e.target?.result?r("Failed to read string contents of input file"):t(e.target.result)})),n.addEventListener("error",(()=>{r("Failed to read string contents of input file")})),n.readAsText(e)}))}async function F(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j;const r=await Z(e);for(const n of t){const[t]=n(r);if(t){if("object"!=typeof t||null===t)throw new TypeError("Input JSON is not an object");return _(t,e.name)}}throw new Error("Failed to parse input JSON")}},"./app/utils/profiling/profile/profile.tsx":(e,t,r)=>{r.d(t,{N:()=>a});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=(r("../node_modules/core-js/modules/es.array.push.js"),r("../node_modules/core-js/modules/es.array.unshift.js"),r("./app/utils.tsx")),i=r("./app/utils/profiling/callTreeNode.tsx"),o=r("./app/utils/profiling/frame.tsx");class a{constructor(e){let{duration:t,startedAt:r,endedAt:s,name:a,unit:l,threadId:u}=e;(0,n.Z)(this,"duration",void 0),(0,n.Z)(this,"startedAt",void 0),(0,n.Z)(this,"endedAt",void 0),(0,n.Z)(this,"threadId",void 0),(0,n.Z)(this,"unit","microseconds"),(0,n.Z)(this,"name","Unknown"),(0,n.Z)(this,"appendOrderTree",new i.n(o.R.Root,null)),(0,n.Z)(this,"framesInStack",new Set),(0,n.Z)(this,"minFrameDuration",Number.POSITIVE_INFINITY),(0,n.Z)(this,"samples",[]),(0,n.Z)(this,"weights",[]),(0,n.Z)(this,"rawWeights",[]),(0,n.Z)(this,"stats",{discardedSamplesCount:0,negativeSamplesCount:0}),this.threadId=u,this.duration=t,this.startedAt=r,this.endedAt=s,this.name=a,this.unit=l}isEmpty(){return this===a.Empty}trackSampleStats(e){0===e&&this.stats.discardedSamplesCount++,e<0&&this.stats.negativeSamplesCount++,e>0&&this.rawWeights.push(e)}forEach(e,t){let r=[],n=0,i=0;for(const o of this.samples){let a=o;for(;a&&!a.isRoot()&&-1===r.indexOf(a);)a=a.parent;for(;r.length>0&&(0,s.SI)(r)!==a;)t(r.pop(),n);const l=[];let u=o;for(;u&&!u.isRoot()&&u!==a;)l.unshift(u),u=u.parent;for(const t of l)e(t,n);r=r.concat(l),n+=this.weights[i++]}for(let e=r.length-1;e>=0;e--)t(r[e],n)}build(){return this.duration=Math.max(this.duration,this.weights.reduce(((e,t)=>e+t),0)),this.minFrameDuration!==Number.POSITIVE_INFINITY&&0!==this.minFrameDuration||(this.minFrameDuration=this.duration),this}}(0,n.Z)(a,"Empty",new a({duration:1e3,startedAt:0,endedAt:1e3,name:"Empty Profile",unit:"milliseconds",threadId:0}).build())},"./app/utils/profiling/profile/utils.tsx":(e,t,r)=>{r.d(t,{GB:()=>l,h1:()=>i,ql:()=>d,vw:()=>o,w_:()=>a}),r("../node_modules/core-js/modules/es.array.push.js");var n=r("./app/utils.tsx"),s=r("./app/utils/profiling/frame.tsx");function i(e){const t={};for(let r=0;r<e.length;r++){const n=e[r];t[r]=new s.R({key:r,name:n.function??"unknown",line:n.lineno,column:n.colno})}return t}function o(e,t,r){return r?t.reduce(((e,t,n)=>(e[n]=new s.R({key:n,resource:void 0!==t.resourceId?r.resources[t.resourceId]:void 0,...t},"web"),e)),{}):t.reduce(((t,r,n)=>(t[n]=new s.R({key:n,...r},e),t)),{})}function a(e){let t=null;return function(r){return t?(t.args===r&&void 0!==t.args&&void 0!==r||(t.args=r,t.value=e(r)),t.value):(t={args:r,value:e(r)},t.value)}}function l(e,t,r){if(!(0,n.ri)(e))return t();const s=e.startChild(r);try{return t()}catch(e){throw s.setStatus("internal_error"),e}finally{s.finish()}}function u(e,t){const r=[];for(const n of e){const e={...n,parent:null,children:[]},s=t[n.key];if(s){for(const r of s)e.children.push(...u([r],t));r.push(e)}}return r}const d=e=>{const t={},r=[];return function(e,t,r){function n(e,s){if(t[e.key]||(t[e.key]=[]),t[e.key].push(s),e.children.length)for(let t=0;t<e.children.length;t++)n(e.children[t],e);else r.push(e)}for(let s=0;s<e.length;s++){e[s].children?.length||r.push(e[s]),t[e[s].key]||(t[e[s].key]=[]);for(let t=0;t<e[s].children.length;t++)n(e[s].children[t],e[s])}}(e,t,r),u(r,t)}},"./app/utils/profiling/routes.tsx":(e,t,r)=>{function n(e){let{orgSlug:t,projectSlug:r,profileId:n}=e;return`/organizations/${t}/profiling/profile/${r}/${n}/flamechart/`}function s(e){let{orgSlug:t,query:r}=e;const n=function(e){let{orgSlug:t}=e;return`/organizations/${t}/profiling/`}({orgSlug:t});return{pathname:n,query:{...r}}}function i(e){let{orgSlug:t,projectSlug:r,transaction:n,query:s}=e;const i=function(e){let{orgSlug:t,projectSlug:r}=e;return`/organizations/${t}/profiling/summary/${r}/`}({orgSlug:t,projectSlug:r});return{pathname:i,query:{...s,transaction:n}}}function o(e){let{orgSlug:t,projectSlug:r,profileId:s,query:i}=e;return{pathname:n({orgSlug:t,projectSlug:r,profileId:s}),query:{...i}}}function a(e){let{orgSlug:t,projectSlug:r,profileId:n,query:s}=e;const i=function(e){let{orgSlug:t,projectSlug:r,profileId:n}=e;return`/organizations/${t}/profiling/profile/${r}/${n}/details/`}({orgSlug:t,projectSlug:r,profileId:n});return{pathname:i,query:{...s}}}r.d(t,{O$:()=>n,Qy:()=>a,R0:()=>i,TH:()=>o,XR:()=>s})},"./app/utils/profiling/weightedNode.tsx":(e,t,r)=>{r.d(t,{$:()=>s});var n=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js");class s{constructor(){(0,n.Z)(this,"totalWeight",0),(0,n.Z)(this,"selfWeight",0)}addToTotalWeight(e){return this.totalWeight+=e,this.totalWeight}addToSelfWeight(e){return this.selfWeight+=e,this.selfWeight}}},"./app/views/profiling/profileGroupProvider.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>$,useProfileGroup:()=>N,useProfileTransaction:()=>F,useSetProfileGroup:()=>j}),r("../node_modules/core-js/modules/es.error.cause.js");var n=r("../node_modules/react/index.js"),s=r("../node_modules/@sentry/core/esm/exports.js"),i=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=r("./app/components/button.tsx"),a=r("./app/components/layouts/thirds.tsx"),l=r("./app/components/links/link.tsx"),u=r("./app/components/profiling/profilingBreadcrumbs.tsx"),d=r("./app/locale.tsx"),p=r("./app/styles/space.tsx"),c=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),h=r("./app/utils/performance/urls.ts"),m=r("./app/utils/profiling/routes.tsx"),f=r("./app/utils/useLocation.tsx"),g=r("./app/utils/useOrganization.tsx"),y=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function v(e){let{transaction:t,projectId:r,eventId:s}=e;const i=(0,f.T)(),p=(0,g.Z)(),v=N(),b="resolved"===v.type?v.data.name:"",x=s??"",T=r??"",_=t?.id?(0,h.D)(p.slug,`${T}:${t.id}`):null,P=(0,n.useMemo)((()=>[{type:"landing",payload:{query:i.query}},{type:"profile summary",payload:{projectSlug:T,transaction:b,query:i.query}},{type:"flamechart",payload:{transaction:b,profileId:x,projectSlug:T,query:i.query,tab:i.pathname.endsWith("details/")?"details":"flamechart"}}]),[i,T,b,x]);return(0,y.BX)(k,{children:[(0,y.tZ)(w,{children:(0,y.tZ)(S,{children:(0,y.tZ)(u.u,{organization:p,trails:P})})}),(0,y.tZ)(a.kP,{children:_&&(0,y.tZ)(o.zx,{size:"sm",onClick:function(){(0,c.Z)("profiling_views.go_to_transaction",{organization:p,source:"transaction_details"})},to:_,children:(0,d.t)("Go to Transaction")})}),(0,y.BX)(I,{underlined:!0,children:[(0,y.tZ)("li",{className:i.pathname.endsWith("flamechart/")?"active":void 0,children:(0,y.tZ)(l.Z,{to:(0,m.TH)({orgSlug:p.slug,projectSlug:T,profileId:x,query:i.query}),children:(0,d.t)("Flamechart")})}),(0,y.tZ)("li",{className:i.pathname.endsWith("details/")?"active":void 0,children:(0,y.tZ)(l.Z,{to:(0,m.Qy)({orgSlug:p.slug,projectSlug:T,profileId:x,query:i.query}),children:(0,d.t)("Details")})})]})]})}v.displayName="ProfileHeader";const w=(0,i.Z)(a.oB,{target:"e1eqzoq73"})("margin-bottom:",(0,p.Z)(1.5),";"),S=(0,i.Z)("div",{target:"e1eqzoq72"})("nav{padding-bottom:",(0,p.Z)(1),";}"),I=(0,i.Z)(a.mL,{target:"e1eqzoq71"})({name:"78ouv5",styles:"a{padding-top:0!important;}"}),k=(0,i.Z)(a.h4,{target:"e1eqzoq70"})("padding:",(0,p.Z)(1)," ",(0,p.Z)(2)," ",(0,p.Z)(0)," ",(0,p.Z)(2),"!important;");var b=r("./app/utils/useApi.tsx"),x=r("./app/utils/profiling/profile/importProfile.tsx"),T=r("./app/utils/useParams.tsx");const _=(0,n.createContext)(null),P=(0,n.createContext)(null);function N(){const e=(0,n.useContext)(_);if(!e)throw new Error("useProfileGroup was called outside of ProfileGroupProvider");return e}function j(){const e=(0,n.useContext)(P);if(!e)throw new Error("useSetProfileGroup was called outside of SetProfileGroupProvider");return e}const Z=(0,n.createContext)(null);function F(){const e=(0,n.useContext)(Z);if(!e)throw new Error("useProfileTransaction was called outside of ProfileTransactionContext");return e}function E(e){const t=(0,b.Z)(),r=(0,g.Z)(),i=(0,T.U)(),[o,a]=(0,n.useState)({type:"initial"}),l=function(e,t,r){const s=(0,b.Z)(),[i,o]=(0,n.useState)({type:"initial"});return(0,n.useEffect)((()=>{if(null!==r)return function(e,t,r,n){return e.requestPromise(`/projects/${t}/${r}/events/${n}/`)}(s,e,t,r).then((e=>{o({type:"resolved",data:e})})).catch((e=>{o({type:"errored",error:e})})),()=>{s.clear()}}),[s,e,t,r]),i}(i.orgId,i.projectId,"resolved"===o.type?o.data.transactionID:null);return(0,n.useEffect)((()=>{if(i.eventId&&i.projectId)return a({type:"loading"}),function(e,t,r,n){return e.requestPromise(`/projects/${n.slug}/${r}/profiling/profiles/${t}/`,{method:"GET",includeAllArgs:!0}).then((e=>{let[r]=e;return(0,x.B)(r,t)}))}(t,i.eventId,i.projectId,r).then((e=>{a({type:"resolved",data:e})})).catch((e=>{const t=e.toString()||(0,d.t)("Error: Unable to load profiles");a({type:"errored",error:t}),s.Tb(e)})),()=>{t.clear()}}),[i.eventId,i.projectId,t,r]),(0,y.tZ)(_.Provider,{value:o,children:(0,y.tZ)(P.Provider,{value:a,children:(0,y.BX)(Z.Provider,{value:l,children:[(0,y.tZ)(v,{eventId:i.eventId,projectId:i.projectId,transaction:"resolved"===l.type?l.data:null}),e.children]})})})}E.displayName="ProfileGroupProvider";const $=E}}]);
//# sourceMappingURL=../sourcemaps/app_views_profiling_profileGroupProvider_tsx.515e47473b6462954cce52a17f06f737.js.map