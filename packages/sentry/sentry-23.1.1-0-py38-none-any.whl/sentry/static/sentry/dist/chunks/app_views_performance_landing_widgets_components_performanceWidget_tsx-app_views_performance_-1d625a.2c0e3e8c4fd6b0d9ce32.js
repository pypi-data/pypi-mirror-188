"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_landing_widgets_components_performanceWidget_tsx-app_views_performance_-1d625a"],{"./app/views/performance/landing/widgets/components/performanceWidget.tsx":(e,t,a)=>{a.d(t,{I:()=>K});var n=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=a("../node_modules/react/index.js"),r=a("./app/components/charts/errorPanel.tsx"),s=a("./app/components/placeholder.tsx"),o=a("./app/icons/iconWarning.tsx"),d=a("./app/styles/space.tsx"),l=a("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),c=a("./app/utils/getDynamicText.tsx"),p=(a("../node_modules/core-js/modules/es.array.includes.js"),a("./app/components/tag.tsx")),g=a("./app/utils/useOrganization.tsx"),m=a("./app/views/performance/landing/widgets/utils.tsx"),u=a("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),h=a("./app/utils/performance/contexts/utils.tsx"),y=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const[f,Z]=(0,h.n)({name:"MetricsEnhancedPerformanceDataContext"}),x=e=>{let{children:t,chartSetting:a}=e;const{setAutoSampleState:n}=(0,u.Eg)(),[r,s]=(0,i.useState)(void 0),o=(0,i.useCallback)((e=>{m.zS.includes(a)||(!0===e?n(u.nl.metrics):!1===e&&n(u.nl.transactions),s(e))}),[n,s,a]);return(0,y.tZ)(f,{value:{isMetricsData:r,setIsMetricsData:o},children:t})};x.displayName="MEPDataProvider";const w=Z,v=()=>{const{isMetricsData:e}=w();if(!(0,g.Z)().features.includes("performance-use-metrics"))return null;if(void 0===e)return(0,y.tZ)("span",{"data-test-id":"no-metrics-data-tag"});const t=e?"processed":"indexed";return(0,y.tZ)(p.Z,{"data-test-id":"has-metrics-data-tag",children:t})};v.displayName="MEPTag";var b=a("./app/utils/useApi.tsx"),q=a("./app/components/panels/index.tsx");const j=(0,n.Z)(q.s_,{target:"ekfeesi1"})("padding-top:",(0,d.Z)(2),";margin-bottom:0;"),D=(0,n.Z)("div",{target:"ekfeesi0"})("");function S(e){return e.isErrored?e.errorComponent:e.isLoading&&e.loadingComponent?e.loadingComponent:e.hasData?(0,y.tZ)(i.Fragment,{children:e.dataComponents}):e.emptyComponent}S.displayName="DataStateSwitch";var C=a("./app/utils/dates.tsx");function P(e){const t=e.children??(0,y.tZ)(i.Fragment,{});return e.queries.length?(0,y.tZ)(i.Fragment,{children:e.queries.filter((t=>!t.enabled||t.enabled(e.widgetData))).map((t=>(0,y.tZ)(k,{...e,query:t},t.queryKey)))}):(0,y.tZ)(i.Fragment,{children:t})}function k(e){const t=e.query,a=e.queryProps.eventView.getPageFilters(),n=a.datetime.start?(0,C.hC)(a.datetime.start):null,r=a.datetime.end?(0,C.hC)(a.datetime.end):null;return(0,i.useEffect)((()=>()=>{e.removeWidgetDataForKey(t.queryKey)}),[]),(0,y.tZ)(t.component,{fields:t.fields,yAxis:t.fields,start:n,end:r,period:a.datetime.period,project:a.projects,environment:a.environments,organization:e.queryProps.organization,orgSlug:e.queryProps.organization.slug,eventView:e.queryProps.eventView,query:e.queryProps.eventView.getQueryWithAdditionalConditions(),widgetData:e.widgetData,referrer:(s=e.queryProps.chartSetting,`api.performance.generic-widget-chart.${s.replace(/_/g,"-")}`),children:a=>(0,y.tZ)(i.Fragment,{children:(0,y.tZ)(z,{results:a,...e,query:t})})},t.queryKey);var s}function z(e){const t=w(),{results:a,query:n}=e,r=n.transform(e.queryProps,a,e.query);return(0,i.useEffect)((()=>{const i=a?.seriesAdditionalInfo?.[e.queryProps.fields[0]]?.isMetricsData??a?.histograms?.meta?.isMetricsData??a?.tableData?.meta?.isMetricsData;t.setIsMetricsData(i),e.setWidgetDataForKey(n.queryKey,r)}),[r?.hasData,r?.isLoading,r?.isErrored]),(0,y.tZ)(i.Fragment,{})}P.displayName="QueryHandler",k.displayName="SingleQueryHandler",z.displayName="QueryResultSaver";var _=a("./app/components/charts/styles.tsx"),E=a("./app/components/questionTooltip.tsx"),F=a("./app/components/textOverflow.tsx");function N(e){const{title:t,titleTooltip:a,Subtitle:n,HeaderActions:i,InteractiveTitle:r}=e;return(0,y.BX)(T,{children:[(0,y.BX)(M,{children:[(0,y.BX)(W,{"data-test-id":"performance-widget-title",children:[r?(0,y.tZ)(r,{...e}):(0,y.tZ)(F.Z,{children:t}),(0,y.tZ)(v,{}),a&&(0,y.tZ)(E.Z,{position:"top",size:"sm",title:a})]}),n?(0,y.tZ)(n,{...e}):null]}),(0,y.tZ)(I,{children:i&&(0,y.tZ)(i,{...e})})]})}N.displayName="WidgetHeader";const W=(0,n.Z)(_.ws,{target:"e1sjff3s3"})("position:relative;z-index:initial;top:-",(0,d.Z)(.5),";"),M=(0,n.Z)("div",{target:"e1sjff3s2"})({name:"6kz1wu",styles:"display:flex;flex-direction:column;align-items:flex-start"}),T=(0,n.Z)("div",{target:"e1sjff3s1"})("display:flex;justify-content:space-between;align-items:flex-start;gap:",(0,d.Z)(1),";"),I=(0,n.Z)("div",{target:"e1sjff3s0"})("display:flex;align-items:center;gap:",(0,d.Z)(1),";");function K(e){const[t,a]=(0,i.useState)({}),n=t[e.chartSetting]??{},r=(0,i.useRef)(n),s=(0,i.useCallback)(((t,n)=>{const i={...r.current,[t]:n};r.current=i,a({[e.chartSetting]:i})}),[t,a]),o=(0,i.useCallback)((t=>{const n={...r.current};delete n[t],r.current=n,a({[e.chartSetting]:n})}),[t,a]),d={widgetData:n,setWidgetDataForKey:s,removeWidgetDataForKey:o},l=Object.entries(e.Queries).map((e=>{let[t,a]=e;return{...a,queryKey:t}})),c=(0,b.Z)(),p=e.Visualizations.reduce(((e,t)=>e+t.height),0);return(0,y.tZ)(i.Fragment,{children:(0,y.BX)(x,{chartSetting:e.chartSetting,children:[(0,y.tZ)(P,{eventView:e.eventView,widgetData:n,setWidgetDataForKey:s,removeWidgetDataForKey:o,queryProps:e,queries:l,api:c}),(0,y.tZ)(L,{...e,...d,totalHeight:p})]})})}function L(e){const{Visualizations:t,chartHeight:a,totalHeight:n,containerType:i,EmptyComponent:r}=e,o=(e=>{let{containerType:t}=e;return"panel"===t?j:D})({containerType:i}),d=Object.keys(e.Queries).length,p=Object.values(e.widgetData).length!==d,g=!p&&Object.values(e.widgetData).every((e=>!e||e.hasData)),m=Object.values(e.widgetData).some((e=>!e||e.isLoading)),u=!p&&Object.values(e.widgetData).some((e=>e&&e.isErrored));return(0,y.BX)(o,{"data-test-id":"performance-widget-container",children:[(0,y.tZ)(H,{children:(0,y.tZ)(N,{...e})}),(0,y.tZ)(S,{isLoading:m,isErrored:u,hasData:g,errorComponent:(0,y.tZ)(V,{height:n}),dataComponents:t.map(((t,n)=>(0,y.tZ)(H,{noPadding:t.noPadding,bottomPadding:t.bottomPadding,"data-test-id":"widget-state-has-data",onClick:()=>{return t=e.chartSetting,a=e.organization,void(0,l.Z)("performance_views.landingv3.widget.interaction",{organization:a,widget_type:t});var t,a},children:(0,c.Z)({value:(0,y.tZ)(t.component,{grid:A,queryFields:t.fields,widgetData:e.widgetData,height:a}),fixed:(0,y.tZ)(s.Z,{height:`${a}px`})})},n))),loadingComponent:(0,y.tZ)(O,{height:`${n}px`}),emptyComponent:r?(0,y.tZ)(r,{}):(0,y.tZ)(O,{height:`${n}px`})})]})}K.displayName="GenericPerformanceWidget",L.displayName="DataDisplay";const V=e=>(0,y.tZ)(r.Z,{"data-test-id":"widget-state-is-errored",height:`${e.height}px`,children:(0,y.tZ)(o.F,{color:"gray300",size:"lg"})});V.displayName="DefaultErrorComponent";const A={left:(0,d.Z)(0),right:(0,d.Z)(0),top:(0,d.Z)(2),bottom:(0,d.Z)(1)},H=(0,n.Z)("div",{target:"e1fmuurf1"})("padding-left:",(e=>e.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-right:",(e=>e.noPadding?(0,d.Z)(0):(0,d.Z)(2)),";padding-bottom:",(e=>e.bottomPadding?(0,d.Z)(1):(0,d.Z)(0)),";"),O=(0,n.Z)(s.Z,{target:"e1fmuurf0"})({name:"cs3onb",styles:"border-color:transparent;border-bottom-right-radius:inherit;border-bottom-left-radius:inherit"});K.defaultProps={containerType:"panel",chartHeight:200}},"./app/views/performance/landing/widgets/components/selectableList.tsx":(e,t,a)=>{a.d(t,{Nm:()=>w,QE:()=>f,S$:()=>y,ZP:()=>u,qL:()=>Z,xq:()=>x});var n=a("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=a("./app/components/emptyStateWarning.tsx"),r=a("./app/components/forms/controls/radioGroup.tsx"),s=a("./app/components/links/link.tsx"),o=a("./app/components/radio.tsx"),d=a("./app/components/tooltip.tsx"),l=a("./app/icons/index.tsx"),c=a("./app/locale.tsx"),p=a("./app/styles/space.tsx"),g=a("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),m=a("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u(e){return(0,m.tZ)("div",{children:e.items.map(((t,a)=>(0,g.az)(h,{...e,isSelected:a===e.selectedIndex,currentIndex:a,key:a},t())))})}function h(e){let{isSelected:t,currentIndex:a,children:n,setSelectedIndex:i,radioColor:s}=e;return(0,m.BX)(S,{children:[(0,m.tZ)(C,{color:s??"",children:(0,m.tZ)(r.V,{index:a,role:"radio",children:(0,m.tZ)(o.Z,{checked:t,onChange:()=>i(a)})})}),n]})}u.displayName="SelectableList",h.displayName="SelectableItem";const y=(0,n.Z)("div",{target:"e1qhgdqj9"})("text-align:right;display:flex;align-items:center;justify-content:center;padding:0 ",(0,p.Z)(1),";"),f=(0,n.Z)("span",{target:"e1qhgdqj8"})("color:",(e=>e.theme.gray300),";font-size:",(e=>e.theme.fontSizeMedium),";display:inline-block;"),Z=(0,n.Z)(s.Z,{target:"e1qhgdqj7"})({name:"pu304d",styles:"flex-grow:1;display:inherit"}),x=()=>(0,m.BX)(q,{children:[(0,m.tZ)(j,{children:(0,c.t)("No results found")}),(0,m.tZ)(D,{children:(0,c.t)("Transactions may not be listed due to the filters above or a low sampling rate")})]});function w(e){return(0,m.tZ)(v,{title:(0,c.t)("Exclude this transaction from the search filter."),children:(0,m.tZ)(b,{onClick:()=>{e.onClick(),e.setSelectListIndex(0)}})})}x.displayName="WidgetEmptyStateWarning",w.displayName="ListClose";const v=(0,n.Z)(d.u,{target:"e1qhgdqj6"})({name:"1wnowod",styles:"display:flex;align-items:center;justify-content:center"}),b=(0,n.Z)(l.bM,{target:"e1qhgdqj5"})("cursor:pointer;color:",(e=>e.theme.gray200),";"),q=(0,n.Z)(i.Z,{target:"e1qhgdqj4"})({name:"1d607mx",styles:"min-height:300px;justify-content:center;display:flex;align-items:center;flex-direction:column"}),j=(0,n.Z)("span",{target:"e1qhgdqj3"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";color:",(e=>e.theme.gray300),";font-weight:600;margin:0 auto ",(0,p.Z)(1),";"),D=(0,n.Z)("p",{target:"e1qhgdqj2"})("font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.gray300),";max-width:300px;"),S=(0,n.Z)("div",{target:"e1qhgdqj1"})("display:flex;border-top:1px solid ",(e=>e.theme.border),";padding:",(0,p.Z)(1)," ",(0,p.Z)(2),";font-size:",(e=>e.theme.fontSizeMedium),";"),C=(0,n.Z)("div",{target:"e1qhgdqj0"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(e=>e.color),";}")}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_landing_widgets_components_performanceWidget_tsx-app_views_performance_-1d625a.0852638836a73f6ee0130f7e323cf701.js.map