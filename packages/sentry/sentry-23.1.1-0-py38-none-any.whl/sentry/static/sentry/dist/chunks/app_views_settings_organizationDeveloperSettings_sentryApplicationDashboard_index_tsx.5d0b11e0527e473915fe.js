"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationDeveloperSettings_sentryApplicationDashboard_index_tsx"],{"./app/components/charts/lineChart.tsx":(e,t,n)=>{n.d(t,{w:()=>i});var s=n("./app/components/charts/series/lineSeries.tsx"),a=n("./app/components/charts/baseChart.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{series:t,seriesOptions:n,...i}=e;return(0,r.tZ)(a.Z,{...i,series:t.map((e=>{let{seriesName:t,data:a,dataArray:r,...i}=e;return(0,s.Z)({...n,...i,name:t,data:r||a?.map((e=>{let{value:t,name:n}=e;return[n,t]})),animation:!1,animationThreshold:1,animationDuration:0})}))})}i.displayName="LineChart"},"./app/views/asyncView.tsx":(e,t,n)=>{n.d(t,{Z:()=>i});var s=n("./app/components/asyncComponent.tsx"),a=n("./app/components/sentryDocumentTitle.tsx"),r=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends s.Z{getTitle(){return""}render(){return(0,r.tZ)(a.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/organizationDeveloperSettings/sentryApplicationDashboard/index.tsx":(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var s=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=n("../node_modules/react/index.js"),r=n("./app/components/charts/barChart.tsx"),i=n("./app/components/charts/lineChart.tsx"),o=n("./app/components/dateTime.tsx"),l=n("./app/components/links/link.tsx"),d=n("./app/components/panels/index.tsx"),c=n("./app/locale.tsx"),p=n("./app/styles/space.tsx"),h=n("./app/utils/withOrganization.tsx"),u=n("./app/views/asyncView.tsx"),m=n("./app/views/settings/components/settingsPageHeader.tsx"),g=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),Z=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/core-js/modules/es.array.includes.js"),n("../node_modules/lodash/memoize.js")),y=n.n(Z),x=n("./app/components/asyncComponent.tsx"),v=n("./app/components/button.tsx"),b=n("./app/components/checkbox.tsx"),f=n("./app/components/compactSelect.tsx"),w=n("./app/components/emptyMessage.tsx"),k=n("./app/components/links/externalLink.tsx"),j=n("./app/components/loadingIndicator.tsx"),_=n("./app/components/tag.tsx"),C=n("./app/icons/index.tsx"),P=n("./app/utils/dates.tsx"),T=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const z=(0,c.t)("All Events"),B=(0,P.gn)(),I=y()((e=>{let t=[];const n=(e.schema.elements||[]).find((e=>"issue-link"===e.type));return n&&(t=["external_issue.created","external_issue.linked"],(e=>{const t=e=>e.some((e=>"select"===e.type&&"uri"in e)),n=t(e.create.required_fields)||t(e.create.optional_fields||[]),s=t(e.link.required_fields)||t(e.link.optional_fields||[]);return n||s})(n)&&t.push("select_options.requested")),[z,..."internal"!==e.status?["installation.created","installation.deleted"]:[],...e.events.includes("error")?["error.created"]:[],...e.events.includes("issue")?["issue.created","issue.resolved","issue.ignored","issue.assigned"]:[],...e.isAlertable?["event_alert.triggered","metric_alert.open","metric_alert.resolved","metric_alert.critical","metric_alert.warning"]:[],...t]})),X=e=>{let{code:t}=e,n="error";return t<=399&&t>=300?n="warning":t<=299&&t>=100&&(n="success"),(0,T.tZ)(A,{children:(0,T.tZ)(M,{type:n,children:0===t?"timeout":t})})};X.displayName="ResponseCode";const D=e=>{let{date:t,link:n}=e;return n?(0,T.BX)(k.Z,{href:n,children:[(0,T.tZ)(o.Z,{date:t}),(0,T.tZ)($,{size:"xs"})]}):(0,T.tZ)(o.Z,{date:t,format:B?"MMM D, YYYY HH:mm:ss z":"ll LTS z"})};class O extends x.Z{constructor(){super(...arguments),(0,g.Z)(this,"shouldReload",!0),(0,g.Z)(this,"handleChangeEventType",(e=>{this.setState({eventType:e,currentPage:0},this.remountComponent)})),(0,g.Z)(this,"handleChangeErrorsOnly",(()=>{this.setState({errorsOnly:!this.state.errorsOnly,currentPage:0},this.remountComponent)})),(0,g.Z)(this,"handleNextPage",(()=>{this.setState({currentPage:this.state.currentPage+1})})),(0,g.Z)(this,"handlePrevPage",(()=>{this.setState({currentPage:this.state.currentPage-1})}))}get hasNextPage(){return 10*(this.state.currentPage+1)<this.state.requests.length}get hasPrevPage(){return this.state.currentPage>0}getEndpoints(){const{slug:e}=this.props.app,t={};return this.state&&(this.state.eventType!==z&&(t.eventType=this.state.eventType),this.state.errorsOnly&&(t.errorsOnly=!0)),[["requests",`/sentry-apps/${e}/requests/`,{query:t}]]}getDefaultState(){return{...super.getDefaultState(),requests:[],eventType:z,errorsOnly:!1,currentPage:0}}renderLoading(){return this.renderBody()}renderBody(){const{requests:e,eventType:t,errorsOnly:n,currentPage:s}=this.state,{app:r}=this.props,i=e.slice(10*s,10*(s+1));return(0,T.BX)(a.Fragment,{children:[(0,T.tZ)("h5",{children:(0,c.t)("Request Log")}),(0,T.BX)("div",{children:[(0,T.tZ)("p",{children:(0,c.t)("This log shows the status of any outgoing webhook requests from Sentry to your integration.")}),(0,T.BX)(V,{children:[(0,T.tZ)(f.Z,{triggerLabel:t,value:t,options:I(r).map((e=>({value:e,label:e}))),onChange:e=>this.handleChangeEventType(e?.value)}),(0,T.tZ)(L,{onClick:this.handleChangeErrorsOnly,children:(0,T.BX)(E,{children:[(0,T.tZ)(b.Z,{checked:n,onChange:()=>{}}),(0,c.t)("Errors Only")]})})]})]}),(0,T.BX)(d.s_,{children:[(0,T.tZ)(d.V9,{children:(0,T.BX)(S,{hasOrganization:"internal"!==r.status,children:[(0,T.tZ)("div",{children:(0,c.t)("Time")}),(0,T.tZ)("div",{children:(0,c.t)("Status Code")}),"internal"!==r.status&&(0,T.tZ)("div",{children:(0,c.t)("Organization")}),(0,T.tZ)("div",{children:(0,c.t)("Event Type")}),(0,T.tZ)("div",{children:(0,c.t)("Webhook URL")})]})}),this.state.loading?(0,T.tZ)(j.Z,{}):(0,T.tZ)(d.N,{children:i.length>0?i.map(((e,t)=>(0,T.tZ)(d.Lv,{"data-test-id":"request-item",children:(0,T.BX)(S,{hasOrganization:"internal"!==r.status,children:[(0,T.tZ)(D,{date:e.date,link:e.errorUrl}),(0,T.tZ)(X,{code:e.responseCode}),"internal"!==r.status&&(0,T.tZ)("div",{children:e.organization?e.organization.name:null}),(0,T.tZ)("div",{children:e.eventType}),(0,T.tZ)(N,{children:e.webhookUrl})]})},t))):(0,T.tZ)(w.Z,{icon:(0,T.tZ)(C.Gy,{size:"xl"}),children:(0,c.t)("No requests found in the last 30 days.")})})]}),(0,T.BX)(q,{children:[(0,T.tZ)(v.zx,{icon:(0,T.tZ)(C.g6,{direction:"left",size:"sm"}),onClick:this.handlePrevPage,disabled:!this.hasPrevPage,"aria-label":(0,c.t)("Previous page")}),(0,T.tZ)(v.zx,{icon:(0,T.tZ)(C.g6,{direction:"right",size:"sm"}),onClick:this.handleNextPage,disabled:!this.hasNextPage,"aria-label":(0,c.t)("Next page")})]})]})}}const S=(0,s.Z)("div",{target:"e11ya9eg8"})("display:grid;grid-template-columns:1fr 0.5fr ",(e=>e.hasOrganization?"1fr":"")," 1fr 1fr;grid-column-gap:",(0,p.Z)(1.5),";width:100%;align-items:center;"),N=(0,s.Z)("div",{target:"e11ya9eg7"})({name:"1sdjnkx",styles:"word-break:break-word"}),q=(0,s.Z)("div",{target:"e11ya9eg6"})({name:"6izmta",styles:"display:flex;justify-content:flex-end;align-items:center;>:first-child{border-top-right-radius:0;border-bottom-right-radius:0;}>:nth-child(2){margin-left:-1px;border-top-left-radius:0;border-bottom-left-radius:0;}"}),V=(0,s.Z)("div",{target:"e11ya9eg5"})("display:flex;align-items:center;padding-bottom:",(0,p.Z)(1),";>:first-child ",v.Sn,"{border-radius:",(e=>e.theme.borderRadiusLeft),";}"),E=(0,s.Z)("div",{target:"e11ya9eg4"})("display:flex;gap:",(0,p.Z)(1),";align-items:center;"),L=(0,s.Z)(v.zx,{target:"e11ya9eg3"})({name:"9aiwao",styles:"margin-left:-1px;border-top-left-radius:0;border-bottom-left-radius:0"}),$=(0,s.Z)(C.V$,{target:"e11ya9eg2"})("margin-left:6px;color:",(e=>e.theme.subText),";"),A=(0,s.Z)("div",{target:"e11ya9eg1"})("margin:-",(0,p.Z)(.5),";"),M=(0,s.Z)(_.Z,{target:"e11ya9eg0"})("padding:",(0,p.Z)(.5),";display:inline-flex;");class H extends u.Z{getEndpoints(){const{appSlug:e}=this.props.params,t=Math.floor((new Date).getTime()/1e3),n=7776e3;return[["stats",`/sentry-apps/${e}/stats/`,{query:{since:t-n,until:t}}],["interactions",`/sentry-apps/${e}/interaction/`,{query:{since:t-n,until:t}}],["app",`/sentry-apps/${e}/`]]}getTitle(){return(0,c.t)("Integration Dashboard")}renderInstallData(){const{app:e,stats:t}=this.state,{totalUninstalls:n,totalInstalls:s}=t;return(0,T.BX)(a.Fragment,{children:[(0,T.tZ)("h5",{children:(0,c.t)("Installation & Interaction Data")}),(0,T.BX)(Y,{children:[e.datePublished?(0,T.BX)(F,{children:[(0,T.tZ)(G,{children:(0,c.t)("Date published")}),(0,T.tZ)(o.Z,{dateOnly:!0,date:e.datePublished})]}):null,(0,T.BX)(F,{"data-test-id":"installs",children:[(0,T.tZ)(G,{children:(0,c.t)("Total installs")}),(0,T.tZ)("p",{children:s})]}),(0,T.BX)(F,{"data-test-id":"uninstalls",children:[(0,T.tZ)(G,{children:(0,c.t)("Total uninstalls")}),(0,T.tZ)("p",{children:n})]})]}),this.renderInstallCharts()]})}renderInstallCharts(){const{installStats:e,uninstallStats:t}=this.state.stats,n={data:e.map((e=>({name:1e3*e[0],value:e[1]}))),seriesName:(0,c.t)("installed")},s={data:t.map((e=>({name:1e3*e[0],value:e[1]}))),seriesName:(0,c.t)("uninstalled")};return(0,T.BX)(d.s_,{children:[(0,T.tZ)(d.V9,{children:(0,c.t)("Installations/Uninstallations over Last 90 Days")}),(0,T.tZ)(J,{children:(0,T.tZ)(r.v,{series:[n,s],height:150,stacked:!0,isGroupedByDate:!0,legend:{show:!0,orient:"horizontal",data:["installed","uninstalled"],itemWidth:15},yAxis:{type:"value",minInterval:1,max:"dataMax"},xAxis:{type:"time"},grid:{left:(0,p.Z)(4),right:(0,p.Z)(4)}})})]})}renderIntegrationViews(){const{views:e}=this.state.interactions,{organization:t}=this.props,{appSlug:n}=this.props.params;return(0,T.BX)(d.s_,{children:[(0,T.tZ)(d.V9,{children:(0,c.t)("Integration Views")}),(0,T.tZ)(d.N,{children:(0,T.tZ)(U,{data:{Views:e}})}),(0,T.tZ)(d.jH,{children:(0,T.BX)(W,{children:[(0,c.t)("Integration views are measured through views on the "),(0,T.tZ)(l.Z,{to:`/sentry-apps/${n}/external-install/`,children:(0,c.t)("external installation page")}),(0,c.t)(" and views on the Learn More/Install modal on the "),(0,T.tZ)(l.Z,{to:`/settings/${t.slug}/integrations/`,children:(0,c.t)("integrations page")})]})})]})}renderComponentInteractions(){const{componentInteractions:e}=this.state.interactions,t={"stacktrace-link":(0,c.t)("Each link click or context menu open counts as one interaction"),"issue-link":(0,c.t)("Each open of the issue link modal counts as one interaction")};return(0,T.BX)(d.s_,{children:[(0,T.tZ)(d.V9,{children:(0,c.t)("Component Interactions")}),(0,T.tZ)(d.N,{children:(0,T.tZ)(U,{data:e})}),(0,T.tZ)(d.jH,{children:(0,T.tZ)(W,{children:Object.keys(e).map(((e,n)=>t[e]&&(0,T.BX)(a.Fragment,{children:[(0,T.tZ)("strong",{children:`${e}: `}),t[e],(0,T.tZ)("br",{})]},n)))})})]})}renderBody(){const{app:e}=this.state;return(0,T.BX)("div",{children:[(0,T.tZ)(m.Z,{title:`${(0,c.t)("Integration Dashboard")} - ${e.name}`}),"published"===e.status&&this.renderInstallData(),"published"===e.status&&this.renderIntegrationViews(),e.schema.elements&&this.renderComponentInteractions(),(0,T.tZ)(O,{app:e})]})}}const R=(0,h.Z)(H),U=e=>{let{data:t}=e;const n=Object.keys(t).map((e=>({seriesName:e,data:t[e].map((e=>({value:e[1],name:1e3*e[0]})))})));return(0,T.tZ)(J,{children:(0,T.tZ)(i.w,{isGroupedByDate:!0,series:n,grid:{left:(0,p.Z)(4),right:(0,p.Z)(4)},legend:{show:!0,orient:"horizontal",data:Object.keys(t)}})})};U.displayName="InteractionsChart";const Y=(0,s.Z)("div",{target:"e1fjij9n4"})({name:"zjik7",styles:"display:flex"}),F=(0,s.Z)("div",{target:"e1fjij9n3"})("margin-right:",(0,p.Z)(4),";"),G=(0,s.Z)("h6",{target:"e1fjij9n2"})("margin-bottom:",(0,p.Z)(1),";font-size:12px;text-transform:uppercase;color:",(e=>e.theme.subText),";"),W=(0,s.Z)("div",{target:"e1fjij9n1"})("padding:",(0,p.Z)(1.5),";"),J=(0,s.Z)("div",{target:"e1fjij9n0"})("padding-top:",(0,p.Z)(3),";")}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationDeveloperSettings_sentryApplicationDashboard_index_tsx.20e3a51158ced8491cb1ca5e5ae0a1e0.js.map