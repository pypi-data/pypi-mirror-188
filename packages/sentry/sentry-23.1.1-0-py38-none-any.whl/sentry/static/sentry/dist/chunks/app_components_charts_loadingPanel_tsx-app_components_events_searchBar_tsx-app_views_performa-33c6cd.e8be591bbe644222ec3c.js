"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_charts_loadingPanel_tsx-app_components_events_searchBar_tsx-app_views_performa-33c6cd"],{"./app/components/charts/loadingPanel.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=s("./app/components/loadingMask.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const o=(0,n.Z)((e=>{let{height:t,...s}=e;return(0,a.tZ)("div",{...s,children:(0,a.tZ)(r.Z,{})})}),{target:"e16jayu70"})("flex:1;flex-shrink:0;overflow:hidden;height:",(e=>e.height),";position:relative;border-color:transparent;margin-bottom:0;");o.defaultProps={height:"200px"};const i=o},"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>O}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.includes.js");var n=s("../node_modules/react/index.js"),r=s("../node_modules/@sentry/core/esm/exports.js"),a=s("../node_modules/lodash/assign.js"),o=s.n(a),i=s("../node_modules/lodash/flatten.js"),l=s.n(i),c=s("../node_modules/lodash/memoize.js"),d=s.n(c),u=s("../node_modules/lodash/omit.js"),m=s.n(u),p=s("./app/actionCreators/tags.tsx"),g=s("./app/components/smartSearchBar/index.tsx"),h=s("./app/constants/index.tsx"),y=s("./app/types/index.tsx"),f=s("./app/utils.tsx"),x=s("./app/utils/discover/fields.tsx"),k=s("./app/utils/fields/index.ts"),Z=s("./app/utils/measurements/measurements.tsx"),v=s("./app/utils/useApi.tsx"),w=s("./app/utils/withTags.tsx"),b=s("./app/views/dashboards/utils.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const j=new RegExp(`^${h.c$}|\\${h.ir}`,"g"),S=new Set(Object.keys(x.wZ)),C=Object.keys(x.wZ).reduce(((e,t)=>(e[t]={...x.wZ[t],kind:k.IV.FIELD},e)),{}),T=m()(C,x.J8),E=x.$4.reduce(((e,t)=>(e[t]={name:t,kind:k.IV.METRICS},e)),{}),N=Object.keys(x.jg).reduce(((e,t)=>(e[t]={...x.jg[t],kind:k.IV.FIELD},e)),{});function q(e){const{maxSearchItems:t,organization:s,tags:a,omitTags:i,fields:c,projectIds:u,includeSessionTagsValues:h,maxMenuHeight:w,customMeasurements:q}=e,O=(0,v.Z)(),V=(0,n.useRef)(!1),z=(0,n.useMemo)((()=>(e=>e?.length?e.reduce(((e,t)=>(S.has(t.field)||(0,x.GO)(t.field)||(0,b.nk)(t.field)||(e[t.field]={key:t.field,name:t.field,kind:k.IV.FUNCTION}),e)),{}):[])(c)),[c]),D=(0,n.useMemo)((()=>Object.keys(a).reduce(((e,t)=>(e[t]={...a[t],kind:k.IV.TAG},e)),{})),[a]);(0,n.useEffect)((()=>{A.cache.clear?.()}),[u]);const A=d()(((e,t,n)=>{const r=u?.map(String);return(0,x.h1)(e.key)||(0,x.Xr)(e.key)?Promise.resolve([]):(0,p.Fo)({api:O,orgSlug:s.slug,tagKey:e.key,search:t,projectIds:r,endpointParams:n,includeTransactions:!0,includeSessions:h}).then((e=>l()(e.filter((e=>{let{name:t}=e;return(0,f.ri)(t)})).map((e=>{let{name:t}=e;return t})))),(()=>{throw new Error("Unable to fetch event field values")}))}),((e,t)=>{let{key:s}=e;return`${s}-${t}`})),I=e=>{let t;!V.current&&Object.keys(a).length>0&&(t=r.Yr({name:"SearchBar.getTagList"}),V.current=!0);const n=((e,t)=>{const s=Object.keys(e).reduce(((t,s)=>(t[s]={...e[s],kind:k.IV.MEASUREMENT},t)),{});return t?Object.keys(t).reduce(((e,s)=>(e[s]={...t[s],kind:k.IV.MEASUREMENT},e)),s):s})(e,q),l=s.features.includes("performance-view")?Object.assign({},n,z,E,C):Object.assign({},T);o()(l,D,C,N),l.has={key:k.Sh.HAS,name:"Has property",values:Object.keys(l).sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),predefined:!0,kind:k.IV.FIELD};const c=i&&i.length>0?m()(l,i):l;if(t){const e=Object.keys(c).length;t.setTag("tags.totalCount",e);const s=[1,5,10,20,50,100,200,300,400,500,600,700,800,900,1e3,1e4].find((t=>e<=t));t.setTag("tags.totalCount.grouped",`<=${s}`),t.finish()}return c};return(0,_.tZ)(Z.Z,{children:s=>{let{measurements:n}=s;return(0,_.tZ)(g.Z,{hasRecentSearches:!0,savedSearchType:y.L4.EVENT,onGetTagValues:A,supportedTags:I(n),prepareQuery:e=>e.replace(j,""),maxSearchItems:t,excludedTags:[k.Sh.ENVIRONMENT,k.Sh.TOTAL_COUNT],maxMenuHeight:w??300,customPerformanceMetrics:q,...e})}})}q.displayName="SearchBar";const O=(0,w.Z)(q)},"./app/components/loadingMask.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});const n=(0,s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"e9w1nku0"})("background-color:",(e=>e.theme.backgroundSecondary),";border-radius:",(e=>e.theme.borderRadius),";position:absolute;top:0;bottom:0;left:0;right:0;")},"./app/components/performanceDuration.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var n=s("./app/components/duration.tsx"),r=s("./app/utils.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(e){const t=function(e){return(0,r.ri)(e.nanoseconds)}(e)?e.nanoseconds/1e9:function(e){return(0,r.ri)(e.milliseconds)}(e)?e.milliseconds/1e3:e.seconds;return(0,a.tZ)(n.Z,{abbreviation:e.abbreviation,seconds:t,fixedDigits:2})}o.displayName="PerformanceDuration";const i=o},"./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("./app/utils/discover/genericDiscoverQuery.tsx"),r=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function a(e){const{aggregateColumn:t}=e;return function(s){const{eventView:n}=s,r=n.getEventsAPIPayload(s.location);return r.aggregateColumn=t,r.sort=e.sort?e.sort:r.sort,e.allTagKeys&&(r.allTagKeys=e.allTagKeys),e.tagKey&&(r.tagKey=e.tagKey),r}}function o(e,t){return e.aggregateColumn!==t.aggregateColumn||e.sort!==t.sort||e.allTagKeys!==t.allTagKeys||e.tagKey!==t.tagKey}function i(e){return(0,r.tZ)(n.ZP,{route:"events-facets-performance",getRequestPayload:a(e),shouldRefetchData:o,...e})}i.displayName="SegmentExplorerQuery";const l=i},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/react/index.js"),a=s("./app/stores/tagStore.tsx"),o=s("./app/utils/getDisplayName.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends r.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{tags:a.Z.getState()}),(0,n.Z)(this,"unsubscribe",a.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,i.tZ)(e,{tags:t??this.state.tags,...s})}}return t.displayName="WithTags",(0,n.Z)(t,"displayName",`withTags(${(0,o.Z)(e)})`),t}},"./app/views/performance/transactionSummary/transactionOverview/tagExplorer.tsx":(e,t,s)=>{s.d(t,{D_:()=>z,e2:()=>O,xS:()=>V});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),o=s("../node_modules/react-router/es/index.js"),i=s("./app/components/assistant/guideAnchor.tsx"),l=s("./app/components/button.tsx"),c=s("./app/components/charts/styles.tsx"),d=s("./app/components/gridEditable/index.tsx"),u=s("./app/components/gridEditable/sortLink.tsx"),m=s("./app/components/links/link.tsx"),p=s("./app/components/pagination.tsx"),g=s("./app/components/performanceDuration.tsx"),h=s("./app/locale.tsx"),y=s("./app/styles/space.tsx"),f=s("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),x=s("./app/utils/discover/eventView.tsx"),k=s("./app/utils/discover/fields.tsx"),Z=s("./app/utils/formatters.tsx"),v=s("./app/utils/performance/segmentExplorer/segmentExplorerQuery.tsx"),w=s("./app/utils/queryString.tsx"),b=s("./app/utils/tokenizeSearch.tsx"),_=s("./app/views/discover/table/cellAction.tsx"),j=s("./app/views/performance/utils.tsx"),S=s("./app/views/performance/transactionSummary/filter.tsx"),C=s("./app/views/performance/transactionSummary/transactionTags/utils.tsx"),T=s("./app/views/performance/transactionSummary/utils.tsx"),E=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const N="tags_cursor",q=[{key:"key",field:"key",name:"Tag Key",width:-1,column:{kind:"field"}},{key:"tagValue",field:"tagValue",name:"Tag Values",width:-1,column:{kind:"field"}},{key:"aggregate",field:"aggregate",name:"Avg Duration",width:-1,column:{kind:"field"},canSort:!0},{key:"frequency",field:"frequency",name:"Frequency",width:-1,column:{kind:"field"},canSort:!0},{key:"comparison",field:"comparison",name:"Compared To Avg",width:-1,column:{kind:"field"},canSort:!0},{key:"sumdelta",field:"sumdelta",name:"Total Time Lost",width:-1,column:{kind:"field"},canSort:!0}],O=(e,t,s)=>{const n=S.BW[e];return n||((0,j.C$)(t,s)===j.iy.FRONTEND?"measurements.lcp":"transaction.duration")};function V(e){return(0,E.tZ)("div",{className:"truncate",children:e.row.tags_value})}V.displayName="TagValue";class z extends a.Component{constructor(){super(...arguments),(0,n.Z)(this,"state",{widths:[]}),(0,n.Z)(this,"handleResizeColumn",((e,t)=>{const s=[...this.state.widths];s[e]=t.width?Number(t.width):d.z7,this.setState({widths:s})})),(0,n.Z)(this,"getColumnOrder",(e=>{const{widths:t}=this.state;return e.map(((e,s)=>"number"==typeof t[s]?{...e,width:t[s]}:e))})),(0,n.Z)(this,"renderHeadCellWithMeta",((e,t,s)=>(n,r)=>this.renderHeadCell(e,t,n,s[r]))),(0,n.Z)(this,"handleTagValueClick",((e,t,s)=>{const{organization:n}=this.props;(0,f.Z)("performance_views.summary.tag_explorer.tag_value",{organization:n});const r=(0,w.ro)(e.query.query),a=new b.MY(r??"");a.addFilterValues(t,[s]);const i=a.formatString();o.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(i).trim()}})})),(0,n.Z)(this,"handleCellAction",((e,t,s)=>n=>{const{eventView:r,location:a,organization:i}=this.props;(0,f.Z)("performance_views.summary.tag_explorer.cell_action",{organization:i});const l=(0,T.xf)(r.query);(0,_.rh)(l,n,{...e,name:s.id},t),o.browserHistory.push({pathname:a.pathname,query:{...a.query,[N]:void 0,query:l.formatString()}})})),(0,n.Z)(this,"renderBodyCell",((e,t,s)=>{const n=s[t.key],{location:r,organization:a,transactionName:o}=e;if("key"===t.key){const e=(0,C.vG)({orgSlug:a.slug,transaction:o,projectID:(0,w.ro)(r.query.project),query:{...r.query,tagKey:s.tags_key}});return(0,E.tZ)(m.Z,{to:e,onClick:()=>this.onTagKeyClick(),children:s.tags_key})}const i=[_.eX.ADD,_.eX.EXCLUDE];if("tagValue"===t.key){const e={...s,id:s.tags_key};return(0,E.tZ)(_.ZP,{column:t,dataRow:e,handleCellAction:this.handleCellAction(t,s.tags_value,e),allowActions:i,children:(0,E.tZ)("div",{className:"truncate",children:s.tags_value})})}if("frequency"===t.key)return(0,E.tZ)(A,{children:(0,Z.rl)(s.frequency,0)});if("comparison"===t.key){const e=s.comparison,t=(0,Z.rl)(e-1,0);return(0,E.tZ)(A,{children:e>1?(0,h.t)("+%s slower",t):(0,h.t)("%s faster",t)})}return"aggregate"===t.key?(0,E.tZ)(A,{children:(0,E.tZ)(g.Z,{abbreviation:!0,milliseconds:s.aggregate})}):"sumdelta"===t.key?(0,E.tZ)(A,{children:(0,E.tZ)(g.Z,{abbreviation:!0,milliseconds:s.sumdelta})}):n})),(0,n.Z)(this,"renderBodyCellWithData",(e=>(t,s)=>this.renderBodyCell(e,t,s)))}onSortClick(e,t){const{organization:s}=this.props;(0,f.Z)("performance_views.summary.tag_explorer.sort",{organization:s,field:t,direction:e})}renderHeadCell(e,t,s,n){const{location:r}=this.props,a=(0,k.qG)(s.key,s.type,t),o={field:s.key,width:s.width},i=e.sortForField(o,t),l=(0,x.M3)(o,t),c=i?i.kind:void 0,d=i?i.field:void 0;return(0,E.tZ)(u.Z,{align:a,title:n.name,direction:c,canSort:l,generateSortLink:function(){if(!t)return;const s=e.sortOnField(o,t),{sort:n}=s.generateQueryStringObject();return{...r,query:{...r.query,[N]:void 0,tagSort:n}}},onClick:()=>this.onSortClick(c,d)})}onTagKeyClick(){const{organization:e}=this.props;(0,f.Z)("performance_views.summary.tag_explorer.visit_tag_key",{organization:e})}render(){const{eventView:e,organization:t,location:s,currentFilter:n,projects:r,transactionName:o}=this.props,l=(0,w.ro)(s.query?.tagSort),c=(0,w.ro)(s.query?.tags_cursor),u=e.clone();u.fields=q;const m=(0,x.vp)(l),p=u.withSorts(m.length?m:[{field:"sumdelta",kind:"desc"}]),g=O(n,r,p),h=((e,t,s)=>{const n=q.map((e=>({...e}))),r=n.find((e=>"aggregate"===e.key));return r?S.BW[e]?(r.name="Avg Span Duration",n):(0,j.C$)(t,s)===j.iy.FRONTEND?(r.name="Avg LCP",n):n:n})(n,r,p),y=this.getColumnOrder(h),f=p.getSorts();return(0,E.tZ)(v.Z,{eventView:p,orgSlug:t.slug,location:s,aggregateColumn:g,limit:5,cursor:c,children:e=>{let{isLoading:n,tableData:r,pageLinks:l}=e;return(0,E.BX)(a.Fragment,{children:[(0,E.tZ)(i.Z,{target:"tag_explorer",children:(0,E.tZ)(D,{transactionName:o,location:s,organization:t,pageLinks:l})}),(0,E.tZ)(d.ZP,{isLoading:n,data:r&&r.data?r.data:[],columnOrder:y,columnSortBy:f,grid:{renderHeadCell:this.renderHeadCellWithMeta(p,r?.meta||{},h),renderBodyCell:this.renderBodyCellWithData(this.props),onResizeColumn:this.handleResizeColumn},location:s})]})}})}}function D(e){const{pageLinks:t,organization:s,location:n,transactionName:r}=e,a=(0,C.vG)({orgSlug:s.slug,transaction:r,projectID:(0,w.ro)(n.query.project),query:{...n.query}});return(0,E.BX)(I,{children:[(0,E.tZ)("div",{children:(0,E.tZ)(c.OT,{children:(0,h.t)("Suspect Tags")})}),(0,E.tZ)(l.zx,{onClick:()=>{(0,f.Z)("performance_views.summary.tag_explorer.change_page",{organization:s})},to:a,size:"xs","data-test-id":"tags-explorer-open-tags",children:(0,h.t)("View All Tags")}),(0,E.tZ)(L,{pageLinks:t,onCursor:(e,t,n)=>{(0,f.Z)("performance_views.summary.tag_explorer.change_page",{organization:s}),o.browserHistory.push({pathname:t,query:{...n,[N]:e}})},size:"xs"})]})}z.displayName="TagExplorer",D.displayName="TagsHeader";const A=(0,r.Z)("div",{target:"e1ihnfmd2"})({name:"p2k0n3",styles:"text-align:right;font-variant-numeric:tabular-nums;width:100%"}),I=(0,r.Z)("div",{target:"e1ihnfmd1"})("display:grid;grid-template-columns:1fr auto auto;margin-bottom:",(0,y.Z)(1),";align-items:center;"),L=(0,r.Z)(p.Z,{target:"e1ihnfmd0"})("margin:0 0 0 ",(0,y.Z)(1),";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_loadingPanel_tsx-app_components_events_searchBar_tsx-app_views_performa-33c6cd.45e3acd90a4cb49bb4f3a3ee9db6232f.js.map