"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_performance_trends_changedTransactions_tsx"],{"./app/views/performance/trends/changedTransactions.tsx":(e,t,n)=>{n.d(t,{H:()=>G,Z:()=>pe});var r,a=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=(n("../node_modules/core-js/modules/es.array.push.js"),n("../node_modules/core-js/modules/es.error.cause.js"),n("../node_modules/react/index.js")),o=n("../node_modules/react-router/es/index.js"),i=n("./app/components/button.tsx"),d=n("./app/components/charts/styles.tsx"),l=n("./app/components/count.tsx"),c=n("./app/components/dropdownLink.tsx"),p=n("./app/components/duration.tsx"),u=n("./app/components/emptyStateWarning.tsx"),m=n("./app/components/forms/controls/radioGroup.tsx"),g=n("./app/components/idBadge/index.tsx"),h=n("./app/components/links/link.tsx"),x=n("./app/components/loadingIndicator.tsx"),f=n("./app/components/menuItem.tsx"),Z=n("./app/components/pagination.tsx"),y=n("./app/components/panels/index.tsx"),v=n("./app/components/questionTooltip.tsx"),_=n("./app/components/radio.tsx"),w=n("./app/components/tooltip.tsx"),b=n("./app/icons/index.tsx"),S=n("./app/locale.tsx"),E=n("./app/styles/space.tsx"),j=n("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),C=n("./app/utils/formatters.tsx"),T=n("./app/utils/performance/trends/trendsDiscoverQuery.tsx"),L=n("./app/utils/queryString.tsx"),k=n("./app/utils/tokenizeSearch.tsx"),R=n("./app/utils/useApi.tsx"),z=n("./app/utils/withOrganization.tsx"),q=n("./app/utils/withProjects.tsx"),N=n("./app/views/performance/transactionSummary/transactionOverview/charts.tsx"),A=n("./app/views/performance/transactionSummary/utils.tsx"),B=n("./app/views/performance/trends/chart.tsx"),P=n("./app/views/performance/trends/types.tsx"),D=n("./app/views/performance/trends/utils.tsx"),M=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function I(e){switch(e){case P.ER.IMPROVED:return(0,S.t)("Most Improved Transactions");case P.ER.REGRESSION:return(0,S.t)("Most Regressed Transactions");default:throw new Error("No trend type passed")}}function V(e,t,n){const r=(0,D.j_)(t),a=(0,L.ro)(e.query[r]);if(!n)return;return n.find((e=>`${e.transaction}-${e.project}`===a))||(n.length>0?n[0]:void 0)}function X(e,t,n){return function(r){const a=(0,D.j_)(n),s={...e.query};r?s[a]=r?`${r.transaction}-${r.project}`:void 0:delete s[a],o.browserHistory.push({pathname:e.pathname,query:s}),(0,j.Z)("performance_views.trends.widget_interaction",{organization:t,widget_type:n})}}function F(e,t,n,a,s,i,d){const l=(0,D.IO)(e,i,d).column,c=(0,L.ro)(e.query.query),p=new k.MY(c??""),u=p.getFilterValues(l),m=a===r.GREATER_THAN_EQUALS?">":"<";u&&u.forEach((e=>{(e.startsWith(a)||e.startsWith(m))&&p.removeFilterValue(l,e)})),p.addFilterValues(l,[`${a}${n}`]);const g=p.formatString();o.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(g).trim()}}),(0,j.Z)("performance_views.trends.change_duration",{organization:t,widget_type:I(s),value:`${a}${n}`})}function O(e){const{location:t,trendChangeType:n,previousTrendFunction:r,previousTrendColumn:a,organization:i,projects:d,setError:l}=e,c=(0,R.Z)(),p=e.trendView.clone(),u=I(n);(0,D.kM)(p,t,n,d);const m=(e=>(t,n,r)=>{const a={};e===P.ER.IMPROVED?a.improvedCursor=t:e===P.ER.REGRESSION&&(a.regressionCursor=t),delete r[(0,D.j_)(e)],o.browserHistory.push({pathname:n,query:{...r,...a}})})(n),g=(0,L.ro)(t.query[D.vt[n]]),h=e=>{(0,j.Z)("performance_views.trends.widget_pagination",{organization:i,direction:e,widget_type:I(n)})};return(0,M.tZ)(T.ZP,{eventView:p,orgSlug:i.slug,location:t,trendChangeType:n,cursor:g,limit:5,setError:e=>l(e?.message),children:o=>{let{isLoading:l,trendsData:g,pageLinks:f}=o;const y=(0,D.CE)(t),_=(0,D.IO)(t,d,p.project),w=(0,D.RP)(g&&g.events&&g.events.data||[]),b=V(t,n,w),E=g?.stats||{},j=w&&w.slice?w.slice(0,5):[],C=l&&r?r:y.field,T=l&&a?a:_.column,L=(0,S.t)("This compares the baseline (%s) of the past with the present.",y.legendLabel);return(0,M.BX)(U,{"data-test-id":"changed-transactions",children:[(0,M.BX)(W,{children:[(0,M.BX)(K,{children:[u,(0,M.tZ)(v.Z,{size:"sm",position:"top",title:L})]}),l?(0,M.tZ)(x.Z,{style:{margin:"237px auto"}}):(0,M.tZ)(s.Fragment,{children:j.length?(0,M.BX)(s.Fragment,{children:[(0,M.tZ)(Y,{children:(0,M.tZ)(B.Z,{statsData:E,query:p.query,project:p.project,environment:p.environment,start:p.start,end:p.end,statsPeriod:p.statsPeriod,transaction:b,isLoading:l,...e})}),j.map(((r,a)=>(0,M.tZ)(H,{api:c,currentTrendFunction:C,currentTrendColumn:T,trendView:e.trendView,organization:i,transaction:r,index:a,trendChangeType:n,transactions:j,location:t,projects:d,statsData:E,handleSelectTransaction:X(t,i,n)},r.transaction)))]}):(0,M.tZ)(te,{small:!0,children:(0,S.t)("No results")})})]}),(0,M.tZ)(Z.Z,{pageLinks:f,onCursor:m,paginationAnalyticsEvent:h})]})}})}function H(e){const{transaction:t,transactions:n,trendChangeType:a,currentTrendFunction:i,currentTrendColumn:d,index:p,location:u,organization:h,projects:x,handleSelectTransaction:Z,trendView:y}=e,v=D.es[a].default,E=V(u,a,n)===t,j=x.find((e=>{let{slug:n}=e;return n===t.project})),T=t.aggregate_range_2,R=t.aggregate_range_1,z=(0,C.rl)(Math.abs(t.trend_percentage-1),0),q=(0,C.g9)(R/1e3,R<1e3&&R>10?0:2),N=(0,C.g9)(T/1e3,T<1e3&&T>10?0:2),A=(0,S.t)("Over this period, the %s for %s has %s %s from %s to %s",i,d,a===P.ER.IMPROVED?(0,S.t)("decreased"):(0,S.t)("increased"),z,q,N),B=a===P.ER.IMPROVED?R:T,I=a===P.ER.IMPROVED?q:N;return(0,M.BX)(ne,{"data-test-id":"trends-list-item-"+a,children:[(0,M.tZ)(re,{color:v,children:(0,M.tZ)(w.u,{title:(0,M.BX)(le,{children:[(0,M.tZ)("span",{children:(0,S.t)("Total Events")}),(0,M.BX)("span",{children:[(0,M.tZ)(l.Z,{value:t.count_range_1}),(0,M.tZ)(ce,{direction:"right",size:"xs"}),(0,M.tZ)(l.Z,{value:t.count_range_2})]})]}),disableForVisualTest:!0,children:(0,M.tZ)(m.V,{index:p,role:"radio",children:(0,M.tZ)(_.Z,{checked:E,onChange:()=>Z(t)})})})}),(0,M.tZ)(Q,{...e}),(0,M.tZ)(ie,{children:(0,M.tZ)(w.u,{title:A,children:(0,M.BX)(s.Fragment,{children:[a===P.ER.REGRESSION?"+":"",(0,C.rl)(t.trend_percentage-1,0)]})})}),(0,M.BX)(c.Z,{caret:!1,anchorRight:!0,title:(0,M.tZ)(J,{size:"xs",icon:(0,M.tZ)(b.YR,{"data-test-id":"trends-item-action",size:"xs"}),"aria-label":(0,S.t)("Actions")}),children:[(0,M.tZ)(f.Z,{onClick:()=>F(u,h,B,r.LESS_THAN_EQUALS,a,x,y.project),children:(0,M.tZ)(ee,{children:(0,S.t)("Show ≤ %s",I)})}),(0,M.tZ)(f.Z,{onClick:()=>F(u,h,B,r.GREATER_THAN_EQUALS,a,x,y.project),children:(0,M.tZ)(ee,{children:(0,S.t)("Show ≥ %s",I)})}),(0,M.tZ)(f.Z,{onClick:()=>function(e,t){const n=(0,L.ro)(e.query.query),r=new k.MY(n??"");r.addFilterValues("!transaction",[t]);const a=r.formatString();o.browserHistory.push({pathname:e.pathname,query:{...e.query,query:String(a).trim()}})}(u,t.transaction),children:(0,M.tZ)(ee,{children:(0,S.t)("Hide from list")})})]}),(0,M.BX)(se,{children:[j&&(0,M.tZ)(w.u,{title:t.project,children:(0,M.tZ)(g.Z,{avatarSize:16,project:j,hideName:!0})}),(0,M.tZ)(G,{...e})]}),(0,M.tZ)(de,{color:v,children:(0,M.tZ)($,{...e})})]})}!function(e){e.GREATER_THAN_EQUALS=">=",e.LESS_THAN_EQUALS="<="}(r||(r={})),O.displayName="ChangedTransactions",H.displayName="TrendsListItem";const G=e=>{let{transaction:t}=e;const{fromSeconds:n,toSeconds:r,showDigits:a}=(0,D.Kt)(t.aggregate_range_1,t.aggregate_range_2);return(0,M.BX)(oe,{children:[(0,M.tZ)(p.Z,{seconds:n,fixedDigits:a?1:0,abbreviation:!0}),(0,M.tZ)(ce,{direction:"right",size:"xs"}),(0,M.tZ)(p.Z,{seconds:r,fixedDigits:a?1:0,abbreviation:!0})]})};G.displayName="CompareDurations";const $=e=>{let{transaction:t,trendChangeType:n}=e;const{seconds:r,fixedDigits:a,changeLabel:s}=(0,D.wx)(t.trend_difference,n);return(0,M.BX)("span",{children:[(0,M.tZ)(p.Z,{seconds:r,fixedDigits:a,abbreviation:!0})," ",s]})};$.displayName="ValueDelta";const Q=e=>{const{organization:t,trendView:n,transaction:r,projects:a,currentTrendFunction:s,currentTrendColumn:o}=e,i=n.clone(),d=(0,D._H)(r,a),l=(0,A.e1)({orgSlug:t.slug,transaction:String(r.transaction),query:i.generateQueryStringObject(),projectID:d,display:N.D.TREND,trendFunction:s,trendColumn:o});return(0,M.tZ)(ae,{to:l,"data-test-id":"item-transaction-name",children:r.transaction})};Q.displayName="TransactionSummaryLink";const U=(0,a.Z)("div",{target:"efd374915"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"}),W=(0,a.Z)(y.s_,{target:"efd374914"})({name:"154zghl",styles:"margin:0;flex-grow:1"}),Y=(0,a.Z)("div",{target:"efd374913"})("padding:",(0,E.Z)(3),";"),K=(0,a.Z)(d.ws,{target:"efd374912"})("border-radius:",(e=>e.theme.borderRadius),";margin:",(0,E.Z)(2)," ",(0,E.Z)(3),";"),J=(0,a.Z)(i.zx,{target:"efd374911"})({name:"1989ovb",styles:"vertical-align:middle"}),ee=(0,a.Z)("div",{target:"efd374910"})("white-space:nowrap;color:",(e=>e.theme.textColor),";");ee.defaultProps={"data-test-id":"menu-action"};const te=(0,a.Z)(u.Z,{target:"efd37499"})({name:"1t1oqhu",styles:"min-height:300px;justify-content:center"}),ne=(0,a.Z)("div",{target:"efd37498"})("display:grid;grid-template-columns:24px auto 100px 30px;grid-template-rows:repeat(2, auto);grid-column-gap:",(0,E.Z)(1),";border-top:1px solid ",(e=>e.theme.border),";padding:",(0,E.Z)(1)," ",(0,E.Z)(2),";"),re=(0,a.Z)("div",{target:"efd37497"})("grid-row:1/3;input{cursor:pointer;}input:checked::after{background-color:",(e=>e.color),";}"),ae=(0,a.Z)(h.Z,{target:"efd37496"})("font-size:",(e=>e.theme.fontSizeMedium),";margin-right:",(0,E.Z)(1),";",(e=>e.theme.overflowEllipsis),";"),se=(0,a.Z)("div",{target:"efd37495"})("display:flex;align-items:center;font-size:",(e=>e.theme.fontSizeSmall),";"),oe=(0,a.Z)("span",{target:"efd37494"})("color:",(e=>e.theme.gray300),";margin:0 ",(0,E.Z)(1),";"),ie=(0,a.Z)("div",{target:"efd37493"})("text-align:right;font-size:",(e=>e.theme.fontSizeMedium),";"),de=(0,a.Z)("div",{target:"efd37492"})("color:",(e=>e.color),";text-align:right;font-size:",(e=>e.theme.fontSizeSmall),";"),le=(0,a.Z)("div",{target:"efd37491"})({name:"zigog8",styles:"display:flex;flex-direction:column;align-items:center"}),ce=(0,a.Z)(b.CC,{target:"efd37490"})("margin:0 ",(0,E.Z)(1),";"),pe=(0,q.Z)((0,z.Z)(O))},"./app/views/performance/trends/chart.tsx":(e,t,n)=>{n.d(t,{Z:()=>w,k:()=>_}),n("../node_modules/core-js/modules/es.array.push.js");var r=n("../node_modules/react-router/es/index.js"),a=n("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),s=n("./app/components/charts/chartZoom.tsx"),o=n("./app/components/charts/lineChart.tsx"),i=n("./app/components/charts/transitionChart.tsx"),d=n("./app/components/charts/transparentLoadingMask.tsx"),l=n("./app/components/organizations/pageFilters/parse.tsx"),c=n("./app/locale.tsx"),p=n("./app/utils/dates.tsx"),u=n("./app/utils/discover/charts.tsx"),m=n("./app/utils/discover/fields.tsx"),g=n("./app/utils/getDynamicText.tsx"),h=n("./app/utils/queryString.tsx"),x=n("./app/utils/useLocation.tsx"),f=n("./app/utils/useRouter.tsx"),Z=n("./app/views/performance/trends/utils.tsx"),y=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function v(e){return{right:10,top:0,itemGap:12,align:"left",data:[{name:"Baseline",icon:"path://M180 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40z, M810 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40zm, M1440 1000 l0 -40 200 0 200 0 0 40 0 40 -200 0 -200 0 0 -40z"},{name:"Releases"},{name:e}]}}function _(e){let{trendChangeType:t,statsPeriod:n,transaction:_,statsData:w,isLoading:b,start:S,end:E,trendFunctionField:j,disableXAxis:C,disableLegend:T,grid:L,height:k,projects:R,project:z}=e;const q=(0,x.T)(),N=(0,f.Z)(),A=(0,a.u)(),B=e=>{const{selected:n}=e,a=Object.keys(n).filter((e=>!n[e])),s={...q.query};s[(0,Z.P4)(t)]=a;const o={...q,query:s};r.browserHistory.push(o)},P=Z.es[t||""],D=(w&&_?.project&&_?.transaction?w[[_.project,_.transaction].join(",")]:void 0)?.data??[],M=(0,Z.CE)(q,j),I=(0,Z.IO)(q,R,z),V=(0,Z.ed)(M.field,I.column),X=function(e,t){return[{seriesName:t||"Current",data:e.map((e=>{let[t,n]=e;return{name:1e3*t,value:n.reduce(((e,t)=>{let{count:n}=t;return e+n}),0)}}))}]}(D,V),{smoothedResults:F,minValue:O,maxValue:H}=(0,Z.vq)(X,V),G=S?(0,p.hC)(S):null,$=E?(0,p.hC)(E):null,{utc:Q}=(0,l.fK)(q.query),U=(0,h.qP)(q.query[(0,Z.P4)(t)]).reduce(((e,t)=>(e[t]=!1,e)),{}),W=T?{show:!1}:{...v(V),selected:U},Y=b,K=b,J=Math.max(H,_?.aggregate_range_2||0,_?.aggregate_range_1||0),ee=Math.min(O,_?.aggregate_range_1||Number.MAX_SAFE_INTEGER,_?.aggregate_range_2||Number.MAX_SAFE_INTEGER),te=F?F.map((e=>({...e,color:P.default,lineStyle:{opacity:1}}))):[],ne=function(e,t,n,r){if(!(r&&t.length&&t[0].data&&t[0].data.length))return[];const a=parseInt(t[0].data[0].name,10),s=parseInt(t[0].data.slice(-1)[0].name,10);if(s<a)return[];const o={data:[],color:e.textColor,markLine:{data:[],label:{},lineStyle:{color:e.textColor,type:"dashed",width:1},symbol:["none","none"],tooltip:{show:!1}},seriesName:"Baseline"},i={fontSize:11,show:!0,color:e.textColor,silent:!0},d={...o,markLine:{...o.markLine},seriesName:"Baseline"},l={...o,markLine:{...o.markLine},seriesName:"Baseline"},p={...o,markLine:{...o.markLine},seriesName:"Period split"},m=.5*(s-a)+a;return d.markLine.data=[[{value:"Past",coord:[a,r.aggregate_range_1]},{coord:[m,r.aggregate_range_1]}]],d.markLine.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">',"<div>",`<span class="tooltip-label"><strong>${(0,c.t)("Past Baseline")}</strong></span>`,(0,u.CX)(r.aggregate_range_1,"duration"),"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")},l.markLine.data=[[{value:"Present",coord:[m,r.aggregate_range_2]},{coord:[s,r.aggregate_range_2]}]],l.markLine.tooltip={formatter:()=>['<div class="tooltip-series tooltip-series-solo">',"<div>",`<span class="tooltip-label"><strong>${(0,c.t)("Present Baseline")}</strong></span>`,(0,u.CX)(r.aggregate_range_2,"duration"),"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")},p.markLine={data:[{xAxis:m}],label:{show:!1},lineStyle:{color:e.textColor,type:"solid",width:2},symbol:["none","none"],tooltip:{show:!1},silent:!0},d.markLine.label={...i,formatter:"Past",position:"insideStartBottom"},l.markLine.label={...i,formatter:"Present",position:"insideEndBottom"},[d,l,p]}(A,F||[],0,_),re=.1*(J-ee),ae=[...te,...ne],se=(0,u.Xp)(ae),oe={tooltip:{valueFormatter:(e,t)=>(0,u.CX)(e,(0,m.Px)(t))},yAxis:{min:Math.max(0,ee-re),max:J+re,minInterval:se,axisLabel:{color:A.chartLabel,formatter:e=>(0,u.gu)(e,"duration",void 0,se)}}};return(0,y.tZ)(s.Z,{router:N,period:n,start:G,end:$,utc:"true"===Q,children:e=>(0,y.BX)(i.Z,{loading:Y,reloading:K,children:[(0,y.tZ)(d.Z,{visible:K}),(0,g.Z)({value:(0,y.tZ)(o.w,{height:k,...e,...oe,onLegendSelectChanged:B,series:ae,seriesOptions:{showSymbol:!1},legend:W,toolBox:{show:!1},grid:L??{left:"10px",right:"10px",top:"40px",bottom:"0px"},xAxis:C?{show:!1}:void 0}),fixed:"Duration Chart"})]})})}_.displayName="Chart";const w=_}}]);
//# sourceMappingURL=../sourcemaps/app_views_performance_trends_changedTransactions_tsx.85b77527beb24341800a9d3e3c52d7bb.js.map