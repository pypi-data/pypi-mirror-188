image: python:3.9

stages:
  - format
  - test
  - security

before_script:
  - python3 setup.py install

flake8:
  stage: format
  script:
    - flake8 . --config .flake8

isort:
  stage: format
  script:
    - python3 -m isort --line-length=120 --check --diff text_sensitivity

run_tests:
  stage: test
  script:
    - coverage run -m pytest
    - coverage report

  only:
    - master
    - branches
  artifacts:
    when: always

bandit:
  stage: security
  script:
    - bandit -r ./text_sensitivity -x /test
